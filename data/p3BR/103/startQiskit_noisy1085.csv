{'0000': 426, '0001': 664, '0010': 378, '0011': 594, '0100': 367, '0101': 704, '0110': 365, '0111': 621, '1000': 376, '1001': 615, '1010': 350, '1011': 602, '1100': 370, '1101': 615, '1110': 344, '1111': 609}
results end
267
               ┌───────────┐                                           ┌───┐»
     qc_2 -> 0 ┤ U2(π/8,π) ├───────────────────────────────────────────┤ X ├»
               ├───────────┴┐                                     ┌───┐└─┬─┘»
     qc_0 -> 1 ┤ U2(π/8,2π) ├──────────────────────■──────────────┤ X ├──■──»
               └────────────┘                      │              └─┬─┘     »
ancilla_0 -> 2 ────────────────────────────────────┼────────────────┼───────»
                ┌─────────┐  ┌───┐┌─────────────┐┌─┴─┐┌──────────┐  │       »
     qc_1 -> 3 ─┤ U2(0,π) ├──┤ X ├┤ U3(π,π/8,π) ├┤ X ├┤ U1(-π/8) ├──■───────»
                ├─────────┤  └─┬─┘└┬───────────┬┘└───┘└──────────┘          »
     qc_3 -> 4 ─┤ U2(π,π) ├────■───┤ U2(π/8,π) ├────────────────────────────»
                └─────────┘        └───────────┘                            »
         qm: 4/═════════════════════════════════════════════════════════════»
                                                                            »
«               ┌──────────┐     ┌───┐┌─────────┐     ┌───┐          »
«     qc_2 -> 0 ┤ U1(-π/8) ├─────┤ X ├┤ U1(π/8) ├──■──┤ X ├──■───────»
«               └──┬───┬───┘     └─┬─┘└─────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐»
«     qc_0 -> 1 ───┤ X ├──────■────■─────────────┤ X ├──■──┤ X ├┤ X ├»
«                  └─┬─┘      │                  └───┘     └───┘└─┬─┘»
«ancilla_0 -> 2 ─────┼────────┼───────────────────────────────────┼──»
«                    │      ┌─┴─┐                                 │  »
«     qc_1 -> 3 ─────■──────┤ X ├─────────────────────────────────■──»
«                           └───┘                                    »
«     qc_3 -> 4 ─────────────────────────────────────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                          »
«     qc_2 -> 0 ──────────────■────────────────────────────────────────────»
«               ┌──────────┐┌─┴─┐     ┌───┐                      ┌───┐     »
«     qc_0 -> 1 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■──»
«               └──────────┘└───┘  │  └─┬─┘  │            │      └─┬─┘  │  »
«ancilla_0 -> 2 ───────────────────┼────┼────┼────────────┼────────┼────┼──»
«                                ┌─┴─┐  │  ┌─┴─┐        ┌─┴─┐      │  ┌─┴─┐»
«     qc_1 -> 3 ─────────────────┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├»
«                                └───┘     └───┘┌─┴─┐┌──┴───┴───┐     └───┘»
«     qc_3 -> 4 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──────────»
«                                               └───┘└──────────┘          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                 ┌───┐                        »
«     qc_2 -> 0 ────────────────────────────■─────┤ X ├──────■─────────────────»
«                               ┌───┐     ┌─┴─┐   └─┬─┘    ┌─┴─┐               »
«     qc_0 -> 1 ──────────■─────┤ X ├──■──┤ X ├─────■──────┤ X ├────────────■──»
«                         │     └─┬─┘  │  └───┘            └───┘            │  »
«ancilla_0 -> 2 ──────────┼───────┼────┼────────────────────────────────────┼──»
«                       ┌─┴─┐     │  ┌─┴─┐                      ┌───┐     ┌─┴─┐»
«     qc_1 -> 3 ──■─────┤ X ├─────■──┤ X ├──■────────────────■──┤ X ├──■──┤ X ├»
«               ┌─┴─┐┌──┴───┴──┐     └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘»
«     qc_3 -> 4 ┤ X ├┤ U1(π/8) ├──────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├─────»
«               └───┘└─────────┘          └───┘└──────────┘└───┘     └───┘     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                               ┌─────────────┐»
«     qc_2 -> 0 ─────────────────────────────────────────────■──┤ U3(π,π/8,π) ├»
«                                                ┌───┐     ┌─┴─┐└─┬─────────┬─┘»
«     qc_0 -> 1 ──────────────────────────────■──┤ X ├──■──┤ X ├──┤ U1(π/8) ├──»
«                                             │  └─┬─┘  │  └───┘  └─────────┘  »
«ancilla_0 -> 2 ──────────────────────────────┼────┼────┼──────────────────────»
«               ┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  ┌─┴─┐          ┌───┐     »
«     qc_1 -> 3 ┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────┤ X ├─────»
«               └─────────┘└─┬─┘└──────────┘└───┘     └───┘┌─┴─┐     └─┬─┘     »
«     qc_3 -> 4 ─────────────■─────────────────────────────┤ X ├───────■───────»
«                                                          └───┘               »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           »
«     qc_2 -> 0 ────────────────────────────────────────────────────────────»
«                    ┌───┐ ┌──────────┐                  ┌───┐   ┌─────────┐»
«     qc_0 -> 1 ─────┤ X ├─┤ U1(-π/8) ├──────────────────┤ X ├───┤ U1(π/8) ├»
«                    └─┬─┘ └──────────┘                  └─┬─┘   └─────────┘»
«ancilla_0 -> 2 ───────┼───────────────────────────────────┼────────────────»
«                      │  ┌───────────┐     ┌───┐          │     ┌─────────┐»
«     qc_1 -> 3 ──■────■──┤ U3(π,0,π) ├──■──┤ X ├──■───────■─────┤ U1(π/8) ├»
«               ┌─┴─┐     └───────────┘┌─┴─┐└─┬─┘┌─┴─┐┌─────────┐└─────────┘»
«     qc_3 -> 4 ┤ X ├──────────────────┤ X ├──■──┤ X ├┤ U1(π/8) ├───────────»
«               └───┘                  └───┘     └───┘└─────────┘           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                              ┌───┐┌──────────┐┌───┐     ┌───┐          »
«     qc_2 -> 0 ───────────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────»
«                    ┌───┐     └─┬─┘└──────────┘└─┬─┘┌─┴─┐└─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ──■──┤ X ├──■────■────────────────■──┤ X ├──■──┤ X ├──■──»
«                 │  └─┬─┘  │                        └───┘     └───┘  │  »
«ancilla_0 -> 2 ──┼────┼────┼─────────────────────────────────────────┼──»
«               ┌─┴─┐  │  ┌─┴─┐        ┌───┐                        ┌─┴─┐»
«     qc_1 -> 3 ┤ X ├──■──┤ X ├──■─────┤ X ├──────■─────────────────┤ X ├»
«               └───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐               └───┘»
«     qc_3 -> 4 ───────────────┤ X ├─────■──────┤ X ├────────────────────»
«                              └───┘            └───┘                    »
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«                           ┌───┐                     ┌───┐          »
«     qc_2 -> 0 ─────■──────┤ X ├──■────────────■─────┤ X ├──■───────»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐        ┌─┴─┐   └─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ───┤ X ├──────■──┤ X ├──■─────┤ X ├─────■──┤ X ├──■──»
«                  └───┘         └───┘  │     └───┘        └───┘  │  »
«ancilla_0 -> 2 ────────────────────────┼─────────────────────────┼──»
«               ┌──────────┐          ┌─┴─┐┌─────────┐          ┌─┴─┐»
«     qc_1 -> 3 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├──────────┤ X ├»
«               └──────────┘          └───┘└─────────┘          └───┘»
«     qc_3 -> 4 ─────────────────────────────────────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                           ┌───┐                  ┌───┐                   »
«     qc_2 -> 0 ─────■──────┤ X ├──■─────────■─────┤ X ├──────■────────────»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐     ┌─┴─┐   └─┬─┘    ┌─┴─┐          »
«     qc_0 -> 1 ───┤ X ├──────■──┤ X ├──■──┤ X ├─────■──────┤ X ├──────────»
«                  └───┘         └───┘  │  └───┘            └───┘          »
«ancilla_0 -> 2 ────────────────────────┼──────────────────────────────────»
«               ┌──────────┐          ┌─┴─┐                      ┌───┐     »
«     qc_1 -> 3 ┤ U1(-π/8) ├──────────┤ X ├──■────────────────■──┤ X ├──■──»
«               └──────────┘          └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_3 -> 4 ───────────────────────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├»
«                                          └───┘└──────────┘└───┘     └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                    »
«     qc_2 -> 0 ──────────────────────────────────────────────────■──»
«                                                     ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ──■────────────────────────────────■──┤ X ├──■──┤ X ├»
«                 │                                │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──┼────────────────────────────────┼────┼────┼───────»
«               ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├─────»
«               └───┘└─────────┘└─┬─┘└──────────┘└───┘     └───┘     »
«     qc_3 -> 4 ──────────────────■──────────────────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                              »
«     qc_2 -> 0 ───────────────────────────────────────────────────────────────»
«               ┌─────────┐     ┌───┐                           ┌─────────────┐»
«     qc_0 -> 1 ┤ U1(π/8) ├──■──┤ X ├──■─────────────────────■──┤ U3(π,π/8,π) ├»
«               └─────────┘  │  └─┬─┘  │                     │  └─────────────┘»
«ancilla_0 -> 2 ─────────────┼────┼────┼─────────────────────┼─────────────────»
«                          ┌─┴─┐  │  ┌─┴─┐┌───┐┌──────────┐┌─┴─┐  ┌─────────┐  »
«     qc_1 -> 3 ───────────┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──»
«                          └───┘     └───┘└─┬─┘└──────────┘└───┘  └─────────┘  »
«     qc_3 -> 4 ────────────────────────────■──────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                       ┌───┐                             ┌───┐┌──────────┐»
«     qc_2 -> 0 ──■─────┤ X ├──────■──────────────────────┤ X ├┤ U1(-π/8) ├»
«               ┌─┴─┐   └─┬─┘    ┌─┴─┐     ┌─────────────┐└─┬─┘└──────────┘»
«     qc_0 -> 1 ┤ X ├─────■──────┤ X ├──■──┤ U3(π,π/8,π) ├──■──────────────»
«               └───┘            └───┘  │  └─────────────┘                 »
«ancilla_0 -> 2 ────────────────────────┼──────────────────────────────────»
«               ┌───┐┌──────────┐     ┌─┴─┐  ┌─────────┐          ┌───┐    »
«     qc_1 -> 3 ┤ X ├┤ U1(-π/8) ├─────┤ X ├──┤ U1(π/8) ├────■─────┤ X ├────»
«               └─┬─┘├─────────┬┘     └───┘  └─────────┘  ┌─┴─┐   └─┬─┘    »
«     qc_3 -> 4 ──■──┤ U1(π/8) ├──────────────────────────┤ X ├─────■──────»
«                    └─────────┘                          └───┘            »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«               ┌───┐     ┌───┐                      ┌───┐                     »
«     qc_2 -> 0 ┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■──────────────────»
«               └─┬─┘┌─┴─┐└─┬─┘┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐                »
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├──■─────────────»
«                    └───┘     └───┘  │     └───┘         └───┘  │             »
«ancilla_0 -> 2 ──────────────────────┼──────────────────────────┼─────────────»
«                                   ┌─┴─┐┌──────────┐          ┌─┴─┐┌─────────┐»
«     qc_1 -> 3 ──■─────────────────┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├»
«               ┌─┴─┐               └───┘└──────────┘          └───┘└─────────┘»
«     qc_3 -> 4 ┤ X ├──────────────────────────────────────────────────────────»
«               └───┘                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                        »
«     qc_2 -> 0 ─────────────────■───────────────────────────────────────»
«                    ┌───┐     ┌─┴─┐┌──────────┐┌───┐                    »
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├┤ X ├─────────────────■──»
«                 │  └─┬─┘  │  └───┘└──────────┘└─┬─┘                 │  »
«ancilla_0 -> 2 ──┼────┼────┼─────────────────────┼───────────────────┼──»
«               ┌─┴─┐  │  ┌─┴─┐                   │       ┌───┐     ┌─┴─┐»
«     qc_1 -> 3 ┤ X ├──■──┤ X ├───────────────────■────■──┤ X ├──■──┤ X ├»
«               └───┘     └───┘                      ┌─┴─┐└─┬─┘┌─┴─┐└───┘»
«     qc_3 -> 4 ─────────────────────────────────────┤ X ├──■──┤ X ├─────»
«                                                    └───┘     └───┘     »
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«                                                                           »
«     qc_2 -> 0 ─────────────────────────────■──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_0 -> 1 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«                             │  └─┬─┘  │  └───┘└─────────┘└─┬─┘└──────────┘»
«ancilla_0 -> 2 ──────────────┼────┼────┼────────────────────┼──────────────»
«               ┌──────────┐┌─┴─┐  │  ┌─┴─┐                  │              »
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■───────■──────»
«               └──────────┘└───┘     └───┘                        ┌─┴─┐    »
«     qc_3 -> 4 ───────────────────────────────────────────────────┤ X ├────»
«                                                                  └───┘    »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                              »
«     qc_2 -> 0 ───────────────────────────────────────────────────────────────»
«                         ┌───┐┌─────────┐     ┌───┐                           »
«     qc_0 -> 1 ──────────┤ X ├┤ U1(π/8) ├──■──┤ X ├──■─────────────────────■──»
«                         └─┬─┘└─────────┘  │  └─┬─┘  │                     │  »
«ancilla_0 -> 2 ────────────┼───────────────┼────┼────┼─────────────────────┼──»
«               ┌───┐       │             ┌─┴─┐  │  ┌─┴─┐┌───┐┌──────────┐┌─┴─┐»
«     qc_1 -> 3 ┤ X ├──■────■─────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├┤ X ├»
«               └─┬─┘┌─┴─┐                └───┘     └───┘└─┬─┘└──────────┘└───┘»
«     qc_3 -> 4 ──■──┤ X ├─────────────────────────────────■───────────────────»
«                    └───┘                                                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                              ┌─────────────┐                                 »
«     qc_2 -> 0 ────────────■──┤ U3(π,π/8,π) ├─────────────────────────────────»
«               ┌───┐     ┌─┴─┐└─┬─────────┬─┘     ┌───┐ ┌──────────┐          »
«     qc_0 -> 1 ┤ X ├──■──┤ X ├──┤ U1(π/8) ├───────┤ X ├─┤ U1(-π/8) ├──────────»
«               └─┬─┘  │  └───┘  └─────────┘       └─┬─┘ └──────────┘          »
«ancilla_0 -> 2 ──┼────┼─────────────────────────────┼─────────────────────────»
«                 │  ┌─┴─┐          ┌───┐            │  ┌───────────┐     ┌───┐»
«     qc_1 -> 3 ──■──┤ X ├──■───────┤ X ├───────■────■──┤ U3(π,0,π) ├──■──┤ X ├»
«                    └───┘┌─┴─┐     └─┬─┘     ┌─┴─┐     └───────────┘┌─┴─┐└─┬─┘»
«     qc_3 -> 4 ──────────┤ X ├───────■───────┤ X ├──────────────────┤ X ├──■──»
«                         └───┘               └───┘                  └───┘     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                             ┌───┐    »
«     qc_2 -> 0 ──────────────────────────────────────────────┤ X ├────»
«                       ┌───┐   ┌─────────┐     ┌───┐         └─┬─┘    »
«     qc_0 -> 1 ────────┤ X ├───┤ U2(0,π) ├──■──┤ X ├──■────────■──────»
«                       └─┬─┘   └─────────┘  │  └─┬─┘  │               »
«ancilla_0 -> 2 ──────────┼──────────────────┼────┼────┼───────────────»
«                         │     ┌─────────┐┌─┴─┐  │  ┌─┴─┐┌───────────┐»
«     qc_1 -> 3 ──■───────■─────┤ U1(π/8) ├┤ X ├──■──┤ X ├┤ U2(π/8,π) ├»
«               ┌─┴─┐┌─────────┐└─────────┘└───┘     └───┘└───────────┘»
«     qc_3 -> 4 ┤ X ├┤ U1(π/8) ├───────────────────────────────────────»
«               └───┘└─────────┘                                       »
«         qm: 4/═══════════════════════════════════════════════════════»
«                                                                      »
«               ┌──────────┐┌───┐     ┌───┐                      ┌───┐     »
«     qc_2 -> 0 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■──»
«               └──────────┘└─┬─┘┌─┴─┐└─┬─┘┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐»
«     qc_0 -> 1 ──────────────■──┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├»
«                                └───┘     └───┘  │     └───┘         └───┘»
«ancilla_0 -> 2 ──────────────────────────────────┼────────────────────────»
«                           ┌───┐               ┌─┴─┐┌──────────┐          »
«     qc_1 -> 3 ─────■──────┤ X ├──■────────────┤ X ├┤ U1(-π/8) ├──────────»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐          └───┘└──────────┘          »
«     qc_3 -> 4 ───┤ X ├──────■──┤ X ├─────────────────────────────────────»
«                  └───┘         └───┘                                     »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                               ┌───┐                      ┌───┐               »
«     qc_2 -> 0 ──────────■─────┤ X ├──■────────────■──────┤ X ├──■─────────■──»
«                       ┌─┴─┐   └─┬─┘┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐     ┌─┴─┐»
«     qc_0 -> 1 ──■─────┤ X ├─────■──┤ X ├──■─────┤ X ├──────■──┤ X ├──■──┤ X ├»
«                 │     └───┘        └───┘  │     └───┘         └───┘  │  └───┘»
«ancilla_0 -> 2 ──┼─────────────────────────┼──────────────────────────┼───────»
«               ┌─┴─┐┌─────────┐          ┌─┴─┐┌──────────┐          ┌─┴─┐     »
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├──────────┤ X ├┤ U1(-π/8) ├──────────┤ X ├──■──»
«               └───┘└─────────┘          └───┘└──────────┘          └───┘┌─┴─┐»
«     qc_3 -> 4 ──────────────────────────────────────────────────────────┤ X ├»
«                                                                         └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                  ┌───┐                                   ┌───┐            »
«     qc_2 -> 0 ───┤ X ├──────■──────────────────────■─────┤ X ├─────■──────»
«                  └─┬─┘    ┌─┴─┐                  ┌─┴─┐   └─┬─┘   ┌─┴─┐    »
«     qc_0 -> 1 ─────■──────┤ X ├────────────■─────┤ X ├─────■─────┤ X ├────»
«                           └───┘            │     └───┘           └───┘    »
«ancilla_0 -> 2 ─────────────────────────────┼──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_1 -> 3 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«               ┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘»
«     qc_3 -> 4 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──────────────»
«               └──────────┘└───┘     └───┘                                 »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                               ┌───┐                                  »
«     qc_2 -> 0 ──────────■─────┤ X ├─────■────────────────────────────»
«                       ┌─┴─┐   └─┬─┘   ┌─┴─┐         ┌──────────┐     »
«     qc_0 -> 1 ──■─────┤ X ├─────■─────┤ X ├──────■──┤ U2(π,2π) ├─────»
«                 │     └───┘           └───┘      │  └──────────┘     »
«ancilla_0 -> 2 ──┼────────────────────────────────┼───────────────────»
«               ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐┌─────────┐ ┌───┐»
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├─┤ X ├»
«               └───┘└─────────┘└─┬─┘└──────────┘└───┘└─────────┘ └─┬─┘»
«     qc_3 -> 4 ──────────────────■─────────────────────────────────■──»
«                                                                      »
«         qm: 4/═══════════════════════════════════════════════════════»
«                                                                      »
«                                                      ┌─────────┐     ┌───┐»
«     qc_2 -> 0 ────────────────────────────────────■──┤ U2(0,π) ├──■──┤ X ├»
«                                       ┌───┐     ┌─┴─┐├─────────┤┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ─────────────────────■──┤ X ├──■──┤ X ├┤ U2(0,π) ├┤ X ├──■──»
«                                    │  └─┬─┘  │  └───┘└─────────┘└───┘     »
«ancilla_0 -> 2 ─────────────────────┼────┼────┼────────────────────────────»
«                   ┌──────────┐   ┌─┴─┐  │  ┌─┴─┐                          »
«     qc_1 -> 3 ────┤ U1(-π/8) ├───┤ X ├──■──┤ X ├──────────────────────────»
«               ┌───┴──────────┴──┐└───┘     └───┘                          »
«     qc_3 -> 4 ┤ U3(-π,π/2,3π/2) ├─────────────────────────────────────────»
«               └─────────────────┘                                         »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                        ┌─────────┐ ░          ┌─┐
«     qc_2 -> 0 ──■───────────────────■──┤ U2(0,π) ├─░──────────┤M├
«               ┌─┴─┐     ┌───┐     ┌─┴─┐└─────────┘ ░    ┌─┐   └╥┘
«     qc_0 -> 1 ┤ X ├──■──┤ X ├──■──┤ X ├────────────░────┤M├────╫─
«               └───┘  │  └─┬─┘  │  └───┘            ░    └╥┘    ║ 
«ancilla_0 -> 2 ───────┼────┼────┼───────────────────░─────╫─────╫─
«                    ┌─┴─┐  │  ┌─┴─┐                 ░ ┌─┐ ║     ║ 
«     qc_1 -> 3 ─────┤ X ├──■──┤ X ├─────────────────░─┤M├─╫─────╫─
«                    └───┘     └───┘                 ░ └╥┘ ║ ┌─┐ ║ 
«     qc_3 -> 4 ─────────────────────────────────────░──╫──╫─┤M├─╫─
«                                                    ░  ║  ║ └╥┘ ║ 
«         qm: 4/════════════════════════════════════════╩══╩══╩══╩═
«                                                       0  1  2  3 
