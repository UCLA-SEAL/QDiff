{'0000': 431, '0001': 351, '0010': 334, '0011': 300, '0100': 337, '0101': 281, '0110': 366, '0111': 390, '1000': 378, '1001': 409, '1010': 418, '1011': 622, '1100': 352, '1101': 445, '1110': 834, '1111': 1752}
results end
215
               ┌─────────────┐                                              »
     qc_3 -> 0 ┤ U3(π,π/8,π) ├──────────────────────────────────────────────»
               └┬────────────┤                   ┌───┐                      »
     qc_0 -> 1 ─┤ U2(π/8,2π) ├────────────────■──┤ X ├──■───────────────────»
                └────────────┘                │  └─┬─┘  │                   »
ancilla_0 -> 2 ───────────────────────────────┼────┼────┼───────────────────»
                              ┌───────────┐ ┌─┴─┐  │  ┌─┴─┐                 »
     qc_2 -> 3 ───────■───────┤ U2(π/8,π) ├─┤ X ├──■──┤ X ├──■──────────────»
                    ┌─┴─┐     ├───────────┴┐└───┘     └───┘┌─┴─┐┌──────────┐»
     qc_1 -> 4 ─────┤ X ├─────┤ U2(π/8,2π) ├───────────────┤ X ├┤ U1(-π/8) ├»
                    └───┘     └────────────┘               └───┘└──────────┘»
         qm: 4/═════════════════════════════════════════════════════════════»
                                                                            »
«                                                                              »
«     qc_3 -> 0 ───────────────────────────────────────────────────────────────»
«                         ┌───┐┌──────────┐     ┌───┐                          »
«     qc_0 -> 1 ──────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■────────────────────■──»
«                         └─┬─┘└──────────┘  │  └─┬─┘  │                    │  »
«ancilla_0 -> 2 ────────────┼────────────────┼────┼────┼────────────────────┼──»
«               ┌───┐       │              ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐»
«     qc_2 -> 3 ┤ X ├──■────■──────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├»
«               └─┬─┘┌─┴─┐                 └───┘     └───┘└─┬─┘└─────────┘└───┘»
«     qc_1 -> 4 ──■──┤ X ├──────────────────────────────────■──────────────────»
«                    └───┘                                                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                               ┌───┐┌──────────┐     ┌───┐»
«     qc_3 -> 0 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├»
«                                     ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ───────────────────■──┤ X ├──■────■──────────────┤ X ├──■──»
«                                  │  └─┬─┘  │                   └───┘     »
«ancilla_0 -> 2 ───────────────────┼────┼────┼─────────────────────────────»
«               ┌──────────┐┌───┐┌─┴─┐  │  ┌─┴─┐                           »
«     qc_2 -> 3 ┤ U1(-π/8) ├┤ X ├┤ X ├──■──┤ X ├───────────────────────────»
«               └──────────┘└─┬─┘└───┘     └───┘                           »
«     qc_1 -> 4 ──────────────■────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                         »
«     qc_3 -> 0 ──■────────────────────■──────────────────────────────────»
«               ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐     ┌───┐          »
«     qc_0 -> 1 ┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────»
«               └───┘└─┬─┘└─────────┘└───┘└──────────┘  │  └─┬─┘  │       »
«ancilla_0 -> 2 ───────┼────────────────────────────────┼────┼────┼───────»
«                      │                              ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_2 -> 3 ───────■──────────────────────────────┤ X ├──■──┤ X ├┤ X ├»
«                                                     └───┘     └───┘└─┬─┘»
«     qc_1 -> 4 ───────────────────────────────────────────────────────■──»
«                                                                         »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                              »
«     qc_3 -> 0 ────────────────────────────■──────────────────────────────────»
«                               ┌───┐     ┌─┴─┐┌──────────┐┌───┐  ┌─────────┐  »
«     qc_0 -> 1 ─────────────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──»
«                            │  └─┬─┘  │  └───┘└──────────┘└─┬─┘  └─────────┘  »
«ancilla_0 -> 2 ─────────────┼────┼────┼─────────────────────┼─────────────────»
«               ┌─────────┐┌─┴─┐  │  ┌─┴─┐                   │  ┌─────────────┐»
«     qc_2 -> 3 ┤ U1(π/8) ├┤ X ├──■──┤ X ├───────────────────■──┤ U3(π,π/8,π) ├»
«               └─────────┘└───┘     └───┘                      └─────────────┘»
«     qc_1 -> 4 ───────────────────────────────────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                    ┌─────────────┐                                         »
«     qc_3 -> 0 ──■──┤ U3(π,π/8,π) ├─────────────────────────────────────────»
«               ┌─┴─┐└─┬──────────┬┘     ┌───┐                               »
«     qc_0 -> 1 ┤ X ├──┤ U1(-π/8) ├───■──┤ X ├──■────────────────────────────»
«               └───┘  └──────────┘   │  └─┬─┘  │                            »
«ancilla_0 -> 2 ──────────────────────┼────┼────┼────────────────────────────»
«                                   ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐     ┌───┐»
«     qc_2 -> 3 ────────────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├──■──┤ X ├»
«                                   └───┘     └───┘└─┬─┘├─────────┤┌─┴─┐└─┬─┘»
«     qc_1 -> 4 ─────────────────────────────────────■──┤ U1(π/8) ├┤ X ├──■──»
«                                                       └─────────┘└───┘     »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                                     ┌───┐┌──────────┐     ┌───┐          »
«     qc_3 -> 0 ──────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────»
«               ┌───┐┌──────────┐┌───┐└─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐»
«     qc_0 -> 1 ┤ X ├┤ U1(-π/8) ├┤ X ├──■──────────────┤ X ├──■──┤ X ├┤ X ├»
«               └─┬─┘└──────────┘└─┬─┘                 └───┘     └───┘└─┬─┘»
«ancilla_0 -> 2 ──┼────────────────┼────────────────────────────────────┼──»
«                 │                │                                    │  »
«     qc_2 -> 3 ──■────────────────■────────────────────────────────────■──»
«                                                                          »
«     qc_1 -> 4 ───────────────────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                           »
«     qc_3 -> 0 ─────────────■──────────────────────────────────────────────»
«               ┌─────────┐┌─┴─┐┌──────────┐┌───┐                           »
«     qc_0 -> 1 ┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├────────────■──────────────»
«               └─────────┘└───┘└──────────┘└─┬─┘            │              »
«ancilla_0 -> 2 ──────────────────────────────┼──────────────┼──────────────»
«                                             │  ┌───┐     ┌─┴─┐┌──────────┐»
«     qc_2 -> 3 ──────────────────────────────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├»
«                                                └─┬─┘┌─┴─┐└───┘└──────────┘»
«     qc_1 -> 4 ───────────────────────────────────■──┤ X ├─────────────────»
«                                                     └───┘                 »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                         »
«     qc_3 -> 0 ─────────────────■────────────────────────────────────────»
«                    ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐     ┌───┐»
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├─────┤ X ├»
«                 │  └─┬─┘  │  └───┘└─────────┘└─┬─┘└──────────┘     └─┬─┘»
«ancilla_0 -> 2 ──┼────┼────┼────────────────────┼─────────────────────┼──»
«               ┌─┴─┐  │  ┌─┴─┐                  │              ┌───┐  │  »
«     qc_2 -> 3 ┤ X ├──■──┤ X ├──────────────────■───────■──────┤ X ├──■──»
«               └───┘     └───┘                        ┌─┴─┐    └─┬─┘     »
«     qc_1 -> 4 ───────────────────────────────────────┤ X ├──────■───────»
«                                                      └───┘              »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                     ┌─────────────┐     »
«     qc_3 -> 0 ───────────────────────────────────■──┤ U3(π,π/8,π) ├─────»
«               ┌─────────┐     ┌───┐┌──────────┐┌─┴─┐└─┬─────────┬─┘┌───┐»
«     qc_0 -> 1 ┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──┤ X ├»
«               └─────────┘     └─┬─┘└──────────┘└───┘  └─────────┘  └─┬─┘»
«ancilla_0 -> 2 ──────────────────┼────────────────────────────────────┼──»
«                  ┌───┐          │                                    │  »
«     qc_2 -> 3 ───┤ X ├─────■────■────────────────────────────────────■──»
«                  └─┬─┘   ┌─┴─┐                                          »
«     qc_1 -> 4 ─────■─────┤ X ├──────────────────────────────────────────»
«                          └───┘                                          »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                         ┌───┐»
«     qc_3 -> 0 ──────────────────────────────────────────────────■───────┤ X ├»
«                ┌──────────┐                    ┌───┐          ┌─┴─┐     └─┬─┘»
«     qc_0 -> 1 ─┤ U1(-π/8) ├────────────────────┤ X ├──────────┤ X ├───────■──»
«                └──────────┘                    └─┬─┘          └───┘          »
«ancilla_0 -> 2 ───────────────────────────────────┼───────────────────────────»
«               ┌───────────┐     ┌───┐            │       ┌─────────────┐     »
«     qc_2 -> 3 ┤ U3(π,0,π) ├──■──┤ X ├──■─────────■───────┤ U3(π,π/8,π) ├─────»
«               └───────────┘┌─┴─┐└─┬─┘┌─┴─┐┌─────────────┐└─────────────┘     »
«     qc_1 -> 4 ─────────────┤ X ├──■──┤ X ├┤ U3(π,π/8,π) ├────────────────────»
«                            └───┘     └───┘└─────────────┘                    »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                    ┌─────────┐                                     »
«     qc_3 -> 0 ──■──┤ U1(π/8) ├─────────────────────────────────────»
«               ┌─┴─┐└──┬───┬──┘┌──────────┐┌───┐     ┌───┐          »
«     qc_0 -> 1 ┤ X ├───┤ X ├───┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────»
«               └───┘   └─┬─┘   └──────────┘└─┬─┘  │  └─┬─┘  │       »
«ancilla_0 -> 2 ──────────┼───────────────────┼────┼────┼────┼───────»
«                         │                   │  ┌─┴─┐  │  ┌─┴─┐     »
«     qc_2 -> 3 ──────────■───────────────────■──┤ X ├──■──┤ X ├──■──»
«                                                └───┘     └───┘┌─┴─┐»
«     qc_1 -> 4 ────────────────────────────────────────────────┤ X ├»
«                                                               └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                           »
«     qc_3 -> 0 ────────────────────────────────────────────────────────────»
«                                                                           »
«     qc_0 -> 1 ─────────────────────────────■──────────────────────────────»
«                                            │                              »
«ancilla_0 -> 2 ─────────────────────────────┼──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_2 -> 3 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«               ┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘»
«     qc_1 -> 4 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──────────────»
«               └──────────┘└───┘     └───┘                                 »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                         ┌───┐┌──────────┐     ┌───┐                          »
«     qc_3 -> 0 ──────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■────────────────────■──»
«               ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐┌─────────┐┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■────■──────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├»
«               └─┬─┘  │                   └───┘     └───┘└─┬─┘└─────────┘└───┘»
«ancilla_0 -> 2 ──┼────┼────────────────────────────────────┼──────────────────»
«                 │  ┌─┴─┐        ┌───┐                     │                  »
«     qc_2 -> 3 ──■──┤ X ├──■─────┤ X ├──────■──────────────■──────────────────»
«                    └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐                               »
«     qc_1 -> 4 ──────────┤ X ├─────■──────┤ X ├───────────────────────────────»
«                         └───┘            └───┘                               »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                              »
«     qc_3 -> 0 ────────────────────────────────────────────────────────────■──»
«               ┌──────────┐     ┌───┐                          ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ┤ U1(-π/8) ├──■──┤ X ├──■────────────────────■──┤ X ├──■──┤ X ├»
«               └──────────┘  │  └─┬─┘  │                    │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──────────────┼────┼────┼────────────────────┼────┼────┼───────»
«                           ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_2 -> 3 ────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├─────»
«                           └───┘     └───┘└─┬─┘└─────────┘└───┘     └───┘     »
«     qc_1 -> 4 ─────────────────────────────■─────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                    ┌─────────────┐»
«     qc_3 -> 0 ──────────────────────────────────■──┤ U3(π,π/8,π) ├»
«               ┌──────────┐┌───┐  ┌─────────┐  ┌─┴─┐└─┬──────────┬┘»
«     qc_0 -> 1 ┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──┤ X ├──┤ U1(-π/8) ├─»
«               └──────────┘└─┬─┘  └─────────┘  └───┘  └──────────┘ »
«ancilla_0 -> 2 ──────────────┼─────────────────────────────────────»
«                             │  ┌─────────────┐          ┌───┐     »
«     qc_2 -> 3 ──────────────■──┤ U3(π,π/8,π) ├──■───────┤ X ├─────»
«                                └─────────────┘┌─┴─┐     └─┬─┘     »
«     qc_1 -> 4 ────────────────────────────────┤ X ├───────■───────»
«                                               └───┘               »
«         qm: 4/════════════════════════════════════════════════════»
«                                                                   »
«                                           ┌───┐                           »
«     qc_3 -> 0 ─────────────────────────■──┤ X ├──■────────────────────────»
«                  ┌───┐    ┌─────────┐┌─┴─┐└─┬─┘┌─┴─┐┌───┐┌──────────┐     »
«     qc_0 -> 1 ───┤ X ├────┤ U1(π/8) ├┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├──■──»
«                  └─┬─┘    └─────────┘└───┘     └───┘└─┬─┘└──────────┘  │  »
«ancilla_0 -> 2 ─────┼──────────────────────────────────┼────────────────┼──»
«                    │      ┌─────────┐┌───┐            │              ┌─┴─┐»
«     qc_2 -> 3 ─────■──────┤ U1(π/8) ├┤ X ├──■─────────■──────────────┤ X ├»
«               ┌──────────┐└─────────┘└─┬─┘┌─┴─┐                      └───┘»
«     qc_1 -> 4 ┤ U1(-π/8) ├─────────────■──┤ X ├───────────────────────────»
«               └──────────┘                └───┘                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                          ┌───┐          »
«     qc_3 -> 0 ────────────────────────────────────■──────┤ X ├──■───────»
«               ┌───┐                             ┌─┴─┐    └─┬─┘┌─┴─┐┌───┐»
«     qc_0 -> 1 ┤ X ├──■────────────────────■─────┤ X ├──────■──┤ X ├┤ X ├»
«               └─┬─┘  │                    │     └───┘         └───┘└─┬─┘»
«ancilla_0 -> 2 ──┼────┼────────────────────┼──────────────────────────┼──»
«                 │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐       │  »
«     qc_2 -> 3 ──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├───────■──»
«                    └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘          »
«     qc_1 -> 4 ────────────■────────────────────────────────■────────────»
«                                                                         »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           »
«     qc_3 -> 0 ──────────────■─────────────────────────────────────────────»
«               ┌──────────┐┌─┴─┐┌─────────┐┌───┐┌──────────┐     ┌───┐     »
«     qc_0 -> 1 ┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──»
«               └──────────┘└───┘└─────────┘└─┬─┘└──────────┘  │  └─┬─┘  │  »
«ancilla_0 -> 2 ──────────────────────────────┼────────────────┼────┼────┼──»
«                                             │              ┌─┴─┐  │  ┌─┴─┐»
«     qc_2 -> 3 ──────────────────────────────■──────────────┤ X ├──■──┤ X ├»
«                                                            └───┘     └───┘»
«     qc_1 -> 4 ────────────────────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                ┌───┐                     »
«     qc_3 -> 0 ──────────────────────────■──────┤ X ├──■──────────────────»
«                                       ┌─┴─┐    └─┬─┘┌─┴─┐     ┌─────────┐»
«     qc_0 -> 1 ──────────────────■─────┤ X ├──────■──┤ X ├──■──┤ U2(0,π) ├»
«                                 │     └───┘         └───┘  │  └─────────┘»
«ancilla_0 -> 2 ──────────────────┼──────────────────────────┼─────────────»
«               ┌───┐┌─────────┐┌─┴─┐┌──────────┐          ┌─┴─┐┌─────────┐»
«     qc_2 -> 3 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├»
«               └─┬─┘└─────────┘└───┘└──────────┘          └───┘└─────────┘»
«     qc_1 -> 4 ──■────────────────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                   ┌─────────┐                           ┌───┐»
«     qc_3 -> 0 ─────────────────■──┤ U2(0,π) ├────────────────────────■──┤ X ├»
«                    ┌───┐     ┌─┴─┐├─────────┴┐     ┌───┐┌─────────┐┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├─────┤ X ├┤ U2(0,π) ├┤ X ├──■──»
«                 │  └─┬─┘  │  └───┘└──────────┘     └─┬─┘└─────────┘└───┘     »
«ancilla_0 -> 2 ──┼────┼────┼──────────────────────────┼───────────────────────»
«               ┌─┴─┐  │  ┌─┴─┐        ┌───┐           │  ┌─────────┐          »
«     qc_2 -> 3 ┤ X ├──■──┤ X ├──■─────┤ X ├──────■────■──┤ U2(0,π) ├──────────»
«               └───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐     └─────────┘          »
«     qc_1 -> 4 ───────────────┤ X ├─────■──────┤ X ├──────────────────────────»
«                              └───┘            └───┘                          »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                    ┌──────────────┐ ░          ┌─┐
«     qc_3 -> 0 ──■──┤ U2(2.9468,π) ├─░──────────┤M├
«               ┌─┴─┐└──────────────┘ ░       ┌─┐└╥┘
«     qc_0 -> 1 ┤ X ├─────────────────░───────┤M├─╫─
«               └───┘                 ░       └╥┘ ║ 
«ancilla_0 -> 2 ──────────────────────░────────╫──╫─
«                                     ░ ┌─┐    ║  ║ 
«     qc_2 -> 3 ──────────────────────░─┤M├────╫──╫─
«                                     ░ └╥┘┌─┐ ║  ║ 
«     qc_1 -> 4 ──────────────────────░──╫─┤M├─╫──╫─
«                                     ░  ║ └╥┘ ║  ║ 
«         qm: 4/═════════════════════════╩══╩══╩══╩═
«                                        0  1  2  3 
