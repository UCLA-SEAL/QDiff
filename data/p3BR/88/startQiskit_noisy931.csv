{'0000': 399, '0001': 318, '0010': 345, '0011': 272, '0100': 351, '0101': 270, '0110': 349, '0111': 262, '1000': 614, '1001': 1100, '1010': 469, '1011': 575, '1100': 445, '1101': 583, '1110': 566, '1111': 1082}
results end
226
               ┌──────────────────┐                                       »
     qc_3 -> 0 ┤ U3(-π,5π/8,3π/2) ├───────────────────────────────────────»
               └──┬────────────┬──┘                        ┌───┐          »
     qc_0 -> 1 ───┤ U2(π/8,2π) ├────────────────────────■──┤ X ├──■───────»
                  └────────────┘                        │  └─┬─┘  │       »
ancilla_0 -> 2 ─────────────────────────────────────────┼────┼────┼───────»
                   ┌─────────┐          ┌───────────┐ ┌─┴─┐  │  ┌─┴─┐     »
     qc_2 -> 3 ────┤ U2(0,π) ├───────■──┤ U2(π/8,π) ├─┤ X ├──■──┤ X ├──■──»
                   └─────────┘     ┌─┴─┐├───────────┴┐└───┘     └───┘┌─┴─┐»
     qc_1 -> 4 ────────────────────┤ X ├┤ U2(π/8,2π) ├───────────────┤ X ├»
                                   └───┘└────────────┘               └───┘»
         qm: 4/═══════════════════════════════════════════════════════════»
                                                                          »
«                                                                           »
«     qc_3 -> 0 ────────────────────────────────────────────────────────────»
«                                ┌───┐┌──────────┐     ┌───┐┌─────────┐     »
«     qc_0 -> 1 ─────────────────┤ X ├┤ U1(-π/8) ├─────┤ X ├┤ U1(π/8) ├──■──»
«                                └─┬─┘└──────────┘     └─┬─┘└─────────┘  │  »
«ancilla_0 -> 2 ───────────────────┼─────────────────────┼───────────────┼──»
«                           ┌───┐  │     ┌───┐           │             ┌─┴─┐»
«     qc_2 -> 3 ────────────┤ X ├──■─────┤ X ├──────■────■─────────────┤ X ├»
«               ┌──────────┐└─┬─┘        └─┬─┘    ┌─┴─┐                └───┘»
«     qc_1 -> 4 ┤ U1(-π/8) ├──■────────────■──────┤ X ├─────────────────────»
«               └──────────┘                      └───┘                     »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                    ┌───┐┌──────────┐     »
«     qc_3 -> 0 ─────────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──»
«               ┌───┐                      ┌───┐     └─┬─┘└──────────┘┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■───────────────────┤ X ├──■────■──────────────┤ X ├»
«               └─┬─┘  │                   └─┬─┘  │                   └───┘»
«ancilla_0 -> 2 ──┼────┼─────────────────────┼────┼────────────────────────»
«                 │  ┌─┴─┐┌───┐┌──────────┐  │  ┌─┴─┐        ┌───┐         »
«     qc_2 -> 3 ──■──┤ X ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■─────┤ X ├─────────»
«                    └───┘└─┬─┘└──────────┘     └───┘┌─┴─┐   └─┬─┘         »
«     qc_1 -> 4 ────────────■────────────────────────┤ X ├─────■───────────»
«                                                    └───┘                 »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«               ┌───┐                                                      »
«     qc_3 -> 0 ┤ X ├──■────────────────────■──────────────────────────────»
«               └─┬─┘┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐┌─────────┐»
«     qc_0 -> 1 ──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├»
«                    └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘└─────────┘»
«ancilla_0 -> 2 ────────────┼────────────────────────────────┼─────────────»
«                           │     ┌───┐                      │     ┌───┐   »
«     qc_2 -> 3 ────────────■─────┤ X ├──────────────────────■─────┤ X ├───»
«                                 └─┬─┘                            └─┬─┘   »
«     qc_1 -> 4 ────────────────────■────────────────────────────────■─────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                         ┌─────────────┐»
«     qc_3 -> 0 ──■────────────────────────────────────■──┤ U3(π,π/8,π) ├»
«               ┌─┴─┐┌──────────┐┌───┐  ┌─────────┐  ┌─┴─┐└─┬──────────┬┘»
«     qc_0 -> 1 ┤ X ├┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──┤ X ├──┤ U1(-π/8) ├─»
«               └───┘└──────────┘└─┬─┘  └─────────┘  └───┘  └──────────┘ »
«ancilla_0 -> 2 ───────────────────┼─────────────────────────────────────»
«                                  │  ┌─────────────┐          ┌───┐     »
«     qc_2 -> 3 ──■────────────────■──┤ U3(π,π/8,π) ├──■───────┤ X ├─────»
«               ┌─┴─┐                 └─────────────┘┌─┴─┐     └─┬─┘     »
«     qc_1 -> 4 ┤ X ├────────────────────────────────┤ X ├───────■───────»
«               └───┘                                └───┘               »
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«                                           ┌───┐                           »
«     qc_3 -> 0 ─────────────────────────■──┤ X ├──■────────────────────────»
«                  ┌───┐    ┌─────────┐┌─┴─┐└─┬─┘┌─┴─┐┌───┐┌──────────┐     »
«     qc_0 -> 1 ───┤ X ├────┤ U1(π/8) ├┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├──■──»
«                  └─┬─┘    └─────────┘└───┘     └───┘└─┬─┘└──────────┘  │  »
«ancilla_0 -> 2 ─────┼──────────────────────────────────┼────────────────┼──»
«                    │      ┌─────────┐┌───┐            │              ┌─┴─┐»
«     qc_2 -> 3 ─────■──────┤ U1(π/8) ├┤ X ├──■─────────■──────────────┤ X ├»
«               ┌──────────┐└─────────┘└─┬─┘┌─┴─┐                      └───┘»
«     qc_1 -> 4 ┤ U1(-π/8) ├─────────────■──┤ X ├───────────────────────────»
«               └──────────┘                └───┘                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                         ┌───┐»
«     qc_3 -> 0 ──────────────────────────────────────────────────────────┤ X ├»
«               ┌───┐                                                ┌───┐└─┬─┘»
«     qc_0 -> 1 ┤ X ├──■────────────────────■─────────────────────■──┤ X ├──■──»
«               └─┬─┘  │                    │                     │  └─┬─┘     »
«ancilla_0 -> 2 ──┼────┼────────────────────┼─────────────────────┼────┼───────»
«                 │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐┌─┴─┐  │       »
«     qc_2 -> 3 ──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├┤ X ├──■───────»
«                    └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘└───┘          »
«     qc_1 -> 4 ────────────■────────────────────────────────■─────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«               ┌──────────┐┌───┐┌─────────┐     ┌───┐┌──────────┐     ┌───┐»
«     qc_3 -> 0 ┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──■──┤ X ├»
«               └──┬───┬───┘└─┬─┘└──┬───┬──┘     └─┬─┘└──────────┘┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ───┤ X ├──────■─────┤ X ├─────■────■──────────────┤ X ├──■──»
«                  └─┬─┘            └─┬─┘     │                   └───┘     »
«ancilla_0 -> 2 ─────┼────────────────┼───────┼─────────────────────────────»
«                    │                │     ┌─┴─┐        ┌───┐              »
«     qc_2 -> 3 ─────■────────────────■─────┤ X ├──■─────┤ X ├──────────────»
«                                           └───┘┌─┴─┐   └─┬─┘              »
«     qc_1 -> 4 ─────────────────────────────────┤ X ├─────■────────────────»
«                                                └───┘                      »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                              »
«     qc_3 -> 0 ──■────────────────────■────────────────────────────────────■──»
«               ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐  ┌─────────┐  ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──┤ X ├»
«               └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘  └─────────┘  └───┘»
«ancilla_0 -> 2 ───────┼────────────────────────────────┼──────────────────────»
«                      │     ┌───┐                      │  ┌─────────────┐     »
«     qc_2 -> 3 ───────■─────┤ X ├─────■────────────────■──┤ U3(π,π/8,π) ├─────»
«                            └─┬─┘   ┌─┴─┐                 └─────────────┘     »
«     qc_1 -> 4 ───────────────■─────┤ X ├─────────────────────────────────────»
«                                    └───┘                                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«               ┌─────────┐                                               »
«     qc_3 -> 0 ┤ U1(π/8) ├───────────────────────────────────────────────»
«               ├─────────┴┐     ┌───┐          ┌───┐          ┌─────────┐»
«     qc_0 -> 1 ┤ U1(-π/8) ├──■──┤ X ├──────────┤ X ├───────■──┤ U1(π/8) ├»
«               └──────────┘  │  └─┬─┘          └─┬─┘       │  └─────────┘»
«ancilla_0 -> 2 ──────────────┼────┼──────────────┼─────────┼─────────────»
«                           ┌─┴─┐  │  ┌───┐       │       ┌─┴─┐   ┌───┐   »
«     qc_2 -> 3 ────────────┤ X ├──■──┤ X ├───────■───────┤ X ├───┤ X ├───»
«                           └───┘     └─┬─┘┌─────────────┐└───┘   └─┬─┘   »
«     qc_1 -> 4 ────────────────────────■──┤ U3(π,π/8,π) ├──────────■─────»
«                                          └─────────────┘                »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                               ┌───┐┌──────────┐     ┌───┐»
«     qc_3 -> 0 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├»
«                                     ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ───────────────────■──┤ X ├──■────■──────────────┤ X ├──■──»
«                                  │  └─┬─┘  │                   └───┘     »
«ancilla_0 -> 2 ───────────────────┼────┼────┼─────────────────────────────»
«               ┌──────────┐┌───┐┌─┴─┐  │  ┌─┴─┐        ┌───┐              »
«     qc_2 -> 3 ┤ U1(-π/8) ├┤ X ├┤ X ├──■──┤ X ├──■─────┤ X ├──────────────»
«               └──────────┘└─┬─┘└───┘     └───┘┌─┴─┐   └─┬─┘              »
«     qc_1 -> 4 ──────────────■─────────────────┤ X ├─────■────────────────»
«                                               └───┘                      »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                         »
«     qc_3 -> 0 ──■────────────────────■──────────────────────────────────»
«               ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐               »
«     qc_0 -> 1 ┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├────────────■──»
«               └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘            │  »
«ancilla_0 -> 2 ───────┼────────────────────────────────┼──────────────┼──»
«                      │                                │  ┌───┐     ┌─┴─┐»
«     qc_2 -> 3 ───────■────────────────────────────────■──┤ X ├──■──┤ X ├»
«                                                          └─┬─┘┌─┴─┐└───┘»
«     qc_1 -> 4 ─────────────────────────────────────────────■──┤ X ├─────»
«                                                               └───┘     »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                           ┌───┐                     ┌───┐          »
«     qc_3 -> 0 ─────■──────┤ X ├──■────────────■─────┤ X ├──■───────»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐        ┌─┴─┐   └─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ───┤ X ├──────■──┤ X ├──■─────┤ X ├─────■──┤ X ├──■──»
«                  └───┘         └───┘  │     └───┘        └───┘  │  »
«ancilla_0 -> 2 ────────────────────────┼─────────────────────────┼──»
«               ┌──────────┐          ┌─┴─┐┌─────────┐          ┌─┴─┐»
«     qc_2 -> 3 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├──────────┤ X ├»
«               └──────────┘          └───┘└─────────┘          └───┘»
«     qc_1 -> 4 ─────────────────────────────────────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                           »
«     qc_3 -> 0 ────────────────────────────────────────────────────────────»
«                                                                 ┌───┐     »
«     qc_0 -> 1 ──────────────────────────────■────────────────■──┤ X ├──■──»
«                                             │                │  └─┬─┘  │  »
«ancilla_0 -> 2 ──────────────────────────────┼────────────────┼────┼────┼──»
«               ┌──────────┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌─┴─┐  │  ┌─┴─┐»
«     qc_2 -> 3 ┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├»
«               └──────────┘└─┬─┘└─────────┘└───┘└──────────┘└───┘     └───┘»
«     qc_1 -> 4 ──────────────■─────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                    ┌─────────────┐                                 »
«     qc_3 -> 0 ──■──┤ U3(π,π/8,π) ├─────────────────────────────────»
«               ┌─┴─┐└─┬─────────┬─┘┌───┐ ┌──────────┐               »
«     qc_0 -> 1 ┤ X ├──┤ U1(π/8) ├──┤ X ├─┤ U1(-π/8) ├───────────────»
«               └───┘  └─────────┘  └─┬─┘ └──────────┘               »
«ancilla_0 -> 2 ──────────────────────┼──────────────────────────────»
«                                     │  ┌───────────┐     ┌───┐     »
«     qc_2 -> 3 ──────────────────────■──┤ U3(π,0,π) ├──■──┤ X ├──■──»
«                                        └───────────┘┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_1 -> 4 ──────────────────────────────────────┤ X ├──■──┤ X ├»
«                                                     └───┘     └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                          ┌───┐     ┌───────────┐            »
«     qc_3 -> 0 ────────────────────────■──┤ X ├──■──┤ U2(π/8,π) ├────────────»
«                  ┌───┐   ┌─────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┬───┬───┘┌──────────┐»
«     qc_0 -> 1 ───┤ X ├───┤ U2(0,π) ├┤ X ├──■──┤ X ├────┤ X ├────┤ U1(-π/8) ├»
«                  └─┬─┘   └─────────┘└───┘     └───┘    └─┬─┘    └──────────┘»
«ancilla_0 -> 2 ─────┼─────────────────────────────────────┼──────────────────»
«                    │     ┌─────────┐                     │                  »
«     qc_2 -> 3 ─────■─────┤ U1(π/8) ├─────────────────────■──────────────────»
«               ┌─────────┐└─────────┘                                        »
«     qc_1 -> 4 ┤ U1(π/8) ├───────────────────────────────────────────────────»
«               └─────────┘                                                   »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                                                                              »
«     qc_3 -> 0 ───────────────────────────────────────────────────────────────»
«               ┌───┐     ┌───┐                      ┌───┐                     »
«     qc_0 -> 1 ┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■──────────────────»
«               └─┬─┘  │  └─┬─┘  │            │      └─┬─┘  │                  »
«ancilla_0 -> 2 ──┼────┼────┼────┼────────────┼────────┼────┼──────────────────»
«                 │  ┌─┴─┐  │  ┌─┴─┐        ┌─┴─┐      │  ┌─┴─┐                »
«     qc_2 -> 3 ──■──┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├──■─────────────»
«                    └───┘     └───┘┌─┴─┐┌──┴───┴───┐     └───┘┌─┴─┐┌─────────┐»
«     qc_1 -> 4 ────────────────────┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├»
«                                   └───┘└──────────┘          └───┘└─────────┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                               ┌───┐                      »
«     qc_3 -> 0 ─────────────────────────■──────┤ X ├──■───────────────────»
«                                      ┌─┴─┐    └─┬─┘┌─┴─┐┌───┐┌──────────┐»
«     qc_0 -> 1 ─────────────────■─────┤ X ├──────■──┤ X ├┤ X ├┤ U1(-π/8) ├»
«                                │     └───┘         └───┘└─┬─┘└──────────┘»
«ancilla_0 -> 2 ─────────────────┼──────────────────────────┼──────────────»
«                    ┌───┐     ┌─┴─┐┌──────────┐┌───┐       │              »
«     qc_2 -> 3 ──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├┤ X ├───────■──────────────»
«               ┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘└─┬─┘                      »
«     qc_1 -> 4 ┤ X ├──■──┤ X ├───────────────────■────────────────────────»
«               └───┘     └───┘                                            »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                    »
«     qc_3 -> 0 ──■──────────────────────────────────────────────────»
«               ┌─┴─┐┌─────────┐┌───┐┌──────────┐     ┌───┐          »
«     qc_0 -> 1 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────»
«               └───┘└─────────┘└─┬─┘└──────────┘  │  └─┬─┘  │       »
«ancilla_0 -> 2 ──────────────────┼────────────────┼────┼────┼───────»
«                                 │              ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_2 -> 3 ──────────────────■──────────────┤ X ├──■──┤ X ├┤ X ├»
«                                                └───┘     └───┘└─┬─┘»
«     qc_1 -> 4 ──────────────────────────────────────────────────■──»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                           ┌───┐                          »
«     qc_3 -> 0 ─────────────────────■──────┤ X ├──■───────────────────────»
«                                  ┌─┴─┐    └─┬─┘┌─┴─┐     ┌─────────┐     »
«     qc_0 -> 1 ─────────────■─────┤ X ├──────■──┤ X ├──■──┤ U2(0,π) ├──■──»
«                            │     └───┘         └───┘  │  └─────────┘  │  »
«ancilla_0 -> 2 ─────────────┼──────────────────────────┼───────────────┼──»
«               ┌─────────┐┌─┴─┐┌──────────┐          ┌─┴─┐┌─────────┐┌─┴─┐»
«     qc_2 -> 3 ┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├┤ X ├»
«               └─────────┘└───┘└──────────┘          └───┘└─────────┘└───┘»
«     qc_1 -> 4 ───────────────────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                              ┌─────────┐                        ┌───┐        »
«     qc_3 -> 0 ────────────■──┤ U2(0,π) ├──────────────────■─────┤ X ├─────■──»
«               ┌───┐     ┌─┴─┐├─────────┴┐     ┌───┐     ┌─┴─┐   └─┬─┘   ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■──┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──┤ X ├─────■─────┤ X ├»
«               └─┬─┘  │  └───┘└──────────┘  │  └─┬─┘  │  └───┘           └───┘»
«ancilla_0 -> 2 ──┼────┼─────────────────────┼────┼────┼───────────────────────»
«                 │  ┌─┴─┐                 ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐     »
«     qc_2 -> 3 ──■──┤ X ├─────────────────┤ X ├──■──┤ X ├┤ X ├┤ U2(0,π) ├──■──»
«                    └───┘                 └───┘     └───┘└─┬─┘├─────────┤┌─┴─┐»
«     qc_1 -> 4 ────────────────────────────────────────────■──┤ U2(0,π) ├┤ X ├»
«                                                              └─────────┘└───┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                          ░    ┌─┐      
«     qc_3 -> 0 ───────────────────────────░────┤M├──────
«                                          ░    └╥┘┌─┐   
«     qc_0 -> 1 ───────────────────────────░─────╫─┤M├───
«                                          ░     ║ └╥┘   
«ancilla_0 -> 2 ───────────────────────────░─────╫──╫────
«               ┌───┐                      ░ ┌─┐ ║  ║    
«     qc_2 -> 3 ┤ X ├──■───────────────────░─┤M├─╫──╫────
«               └─┬─┘┌─┴─┐┌──────────────┐ ░ └╥┘ ║  ║ ┌─┐
«     qc_1 -> 4 ──■──┤ X ├┤ U2(2.9468,π) ├─░──╫──╫──╫─┤M├
«                    └───┘└──────────────┘ ░  ║  ║  ║ └╥┘
«         qm: 4/══════════════════════════════╩══╩══╩══╩═
«                                             0  1  2  3 
