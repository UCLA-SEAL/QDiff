{'0000': 468, '0001': 453, '0010': 445, '0011': 471, '0100': 572, '0101': 1084, '0110': 692, '0111': 1373, '1000': 342, '1001': 321, '1010': 316, '1011': 283, '1100': 314, '1101': 308, '1110': 274, '1111': 284}
results end
252
                  ┌───────────┐                          ┌───┐┌──────────┐     »
     qc_2 -> 0 ───┤ U2(π/8,π) ├──────────────────────────┤ X ├┤ U1(-π/8) ├─────»
                  ├───────────┴┐                    ┌───┐└─┬─┘└──┬───┬───┘     »
     qc_0 -> 1 ───┤ U2(π/8,2π) ├─────■──────────────┤ X ├──■─────┤ X ├──────■──»
                  └────────────┘     │              └─┬─┘        └─┬─┘      │  »
ancilla_0 -> 2 ──────────────────────┼────────────────┼────────────┼────────┼──»
                  ┌────────────┐   ┌─┴─┐┌──────────┐  │            │      ┌─┴─┐»
     qc_1 -> 3 ───┤ U2(π/8,2π) ├───┤ X ├┤ U1(-π/8) ├──■────────────■──────┤ X ├»
               ┌──┴────────────┴──┐└───┘└──────────┘                      └───┘»
     qc_3 -> 4 ┤ U3(-π,5π/8,3π/2) ├────────────────────────────────────────────»
               └──────────────────┘                                            »
         qm: 4/════════════════════════════════════════════════════════════════»
                                                                               »
«               ┌───┐┌─────────┐     ┌───┐                                     »
«     qc_2 -> 0 ┤ X ├┤ U1(π/8) ├──■──┤ X ├──■─────────────────────■────────────»
«               └─┬─┘└─────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐┌──────────┐┌─┴─┐          »
«     qc_0 -> 1 ──■─────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├┤ X ├───────■──»
«                               └───┘     └───┘└─┬─┘└──────────┘└───┘       │  »
«ancilla_0 -> 2 ─────────────────────────────────┼──────────────────────────┼──»
«                                                │              ┌───┐     ┌─┴─┐»
«     qc_1 -> 3 ─────────────────────────────────■───────■──────┤ X ├──■──┤ X ├»
«                                                      ┌─┴─┐    └─┬─┘┌─┴─┐└───┘»
«     qc_3 -> 4 ───────────────────────────────────────┤ X ├──────■──┤ X ├─────»
«                                                      └───┘         └───┘     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                           »
«     qc_2 -> 0 ────────────────────────────────────────────────────────────»
«                                                                 ┌───┐     »
«     qc_0 -> 1 ──────────────────────────────■────────────────■──┤ X ├──■──»
«                                             │                │  └─┬─┘  │  »
«ancilla_0 -> 2 ──────────────────────────────┼────────────────┼────┼────┼──»
«               ┌──────────┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌─┴─┐  │  ┌─┴─┐»
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├»
«               └──────────┘└─┬─┘└─────────┘└───┘└──────────┘└───┘     └───┘»
«     qc_3 -> 4 ──────────────■─────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                            »
«     qc_2 -> 0 ──■──────────────────────────────────────────────────────────»
«               ┌─┴─┐┌─────────┐┌───┐┌──────────┐          ┌───┐ ┌─────────┐ »
«     qc_0 -> 1 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──────────┤ X ├─┤ U1(π/8) ├─»
«               └───┘└─────────┘└─┬─┘└──────────┘          └─┬─┘ └─────────┘ »
«ancilla_0 -> 2 ──────────────────┼──────────────────────────┼───────────────»
«                                 │              ┌───┐       │  ┌───────────┐»
«     qc_1 -> 3 ──────────────────■───────■──────┤ X ├──■────■──┤ U3(π,0,π) ├»
«                                       ┌─┴─┐    └─┬─┘┌─┴─┐     └───────────┘»
«     qc_3 -> 4 ────────────────────────┤ X ├──────■──┤ X ├──────────────────»
«                                       └───┘         └───┘                  »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                                                        ┌───┐          »
«     qc_2 -> 0 ─────────────────────────────────■───────┤ X ├──■───────»
«                    ┌───┐     ┌─────────┐     ┌─┴─┐     └─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ──■──┤ X ├──■──┤ U1(π/8) ├─────┤ X ├───────■──┤ X ├──■──»
«                 │  └─┬─┘  │  └─────────┘     └───┘          └───┘  │  »
«ancilla_0 -> 2 ──┼────┼────┼────────────────────────────────────────┼──»
«               ┌─┴─┐  │  ┌─┴─┐   ┌───┐     ┌──────────┐           ┌─┴─┐»
«     qc_1 -> 3 ┤ X ├──■──┤ X ├───┤ X ├─────┤ U1(-π/8) ├───────────┤ X ├»
«               └───┘     └───┘   └─┬─┘   ┌─┴──────────┴┐          └───┘»
«     qc_3 -> 4 ────────────────────■─────┤ U3(π,π/8,π) ├───────────────»
«                                         └─────────────┘               »
«         qm: 4/════════════════════════════════════════════════════════»
«                                                                       »
«                          ┌───┐┌──────────┐┌───┐     ┌───┐          »
«     qc_2 -> 0 ───────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────»
«               ┌─────────┐└─┬─┘└──────────┘└─┬─┘┌─┴─┐└─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ┤ U1(π/8) ├──■────────────────■──┤ X ├──■──┤ X ├──■──»
«               └─────────┘                      └───┘     └───┘  │  »
«ancilla_0 -> 2 ──────────────────────────────────────────────────┼──»
«               ┌─────────┐        ┌───┐                        ┌─┴─┐»
«     qc_1 -> 3 ┤ U1(π/8) ├──■─────┤ X ├──────■─────────────────┤ X ├»
«               └─────────┘┌─┴─┐   └─┬─┘    ┌─┴─┐               └───┘»
«     qc_3 -> 4 ───────────┤ X ├─────■──────┤ X ├────────────────────»
«                          └───┘            └───┘                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                           »
«     qc_2 -> 0 ─────────────────────────────■──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_0 -> 1 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«                             │  └─┬─┘  │  └───┘└─────────┘└─┬─┘└──────────┘»
«ancilla_0 -> 2 ──────────────┼────┼────┼────────────────────┼──────────────»
«               ┌──────────┐┌─┴─┐  │  ┌─┴─┐                  │              »
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──────────────»
«               └──────────┘└───┘     └───┘                                 »
«     qc_3 -> 4 ────────────────────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                              »
«     qc_2 -> 0 ──■────────────────────────────────────────────────────────────»
«               ┌─┴─┐     ┌───┐                      ┌───┐                     »
«     qc_0 -> 1 ┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■────────────■─────»
«               └───┘  │  └─┬─┘  │            │      └─┬─┘  │            │     »
«ancilla_0 -> 2 ───────┼────┼────┼────────────┼────────┼────┼────────────┼─────»
«                    ┌─┴─┐  │  ┌─┴─┐        ┌─┴─┐      │  ┌─┴─┐        ┌─┴─┐   »
«     qc_1 -> 3 ─────┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├──■─────┤ X ├───»
«                    └───┘     └───┘┌─┴─┐┌──┴───┴───┐     └───┘┌─┴─┐┌──┴───┴──┐»
«     qc_3 -> 4 ────────────────────┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├»
«                                   └───┘└──────────┘          └───┘└─────────┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                 ┌───┐                                   ┌───┐»
«     qc_2 -> 0 ────────────■─────┤ X ├──────■──────────────────────■─────┤ X ├»
«               ┌───┐     ┌─┴─┐   └─┬─┘    ┌─┴─┐                  ┌─┴─┐   └─┬─┘»
«     qc_0 -> 1 ┤ X ├──■──┤ X ├─────■──────┤ X ├────────────■─────┤ X ├─────■──»
«               └─┬─┘  │  └───┘            └───┘            │     └───┘        »
«ancilla_0 -> 2 ──┼────┼────────────────────────────────────┼──────────────────»
«                 │  ┌─┴─┐                      ┌───┐     ┌─┴─┐┌─────────┐┌───┐»
«     qc_1 -> 3 ──■──┤ X ├──■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├»
«                    └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘»
«     qc_3 -> 4 ──────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──»
«                         └───┘└──────────┘└───┘     └───┘                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                          »
«     qc_2 -> 0 ─────■─────────────────────────────────────────────────────»
«                  ┌─┴─┐         ┌─────────────┐                      ┌───┐»
«     qc_0 -> 1 ───┤ X ├──────■──┤ U3(π,π/8,π) ├───────────────────■──┤ X ├»
«                  └───┘      │  └─────────────┘                   │  └─┬─┘»
«ancilla_0 -> 2 ──────────────┼────────────────────────────────────┼────┼──»
«               ┌──────────┐┌─┴─┐  ┌─────────┐  ┌───┐┌──────────┐┌─┴─┐  │  »
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──┤ U1(π/8) ├──┤ X ├┤ U1(-π/8) ├┤ X ├──■──»
«               └──────────┘└───┘  └─────────┘  └─┬─┘├─────────┬┘└───┘     »
«     qc_3 -> 4 ──────────────────────────────────■──┤ U1(π/8) ├───────────»
«                                                    └─────────┘           »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                         ┌─────────────┐                                      »
«     qc_2 -> 0 ───────■──┤ U3(π,π/8,π) ├───────────────■───────────────────■──»
«                    ┌─┴─┐└─────────────┘┌───┐        ┌─┴─┐   ┌──────────┐┌─┴─┐»
«     qc_0 -> 1 ──■──┤ X ├───────■───────┤ X ├──■─────┤ X ├───┤ U1(-π/8) ├┤ X ├»
«                 │  └───┘       │       └─┬─┘  │     └───┘   └──────────┘└───┘»
«ancilla_0 -> 2 ──┼──────────────┼─────────┼────┼──────────────────────────────»
«               ┌─┴─┐          ┌─┴─┐       │  ┌─┴─┐┌─────────┐            ┌───┐»
«     qc_1 -> 3 ┤ X ├──────────┤ X ├───────■──┤ X ├┤ U1(π/8) ├─────■──────┤ X ├»
«               └───┘          └───┘          └───┘└─────────┘   ┌─┴─┐    └─┬─┘»
«     qc_3 -> 4 ─────────────────────────────────────────────────┤ X ├──────■──»
«                                                                └───┘         »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                         »
«     qc_2 -> 0 ───────────────────────────────────────■──────────────────»
«                                          ┌───┐     ┌─┴─┐┌─────────┐┌───┐»
«     qc_0 -> 1 ───────■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├»
«                      │                │  └─┬─┘  │  └───┘└─────────┘└─┬─┘»
«ancilla_0 -> 2 ───────┼────────────────┼────┼────┼────────────────────┼──»
«                    ┌─┴─┐┌──────────┐┌─┴─┐  │  ┌─┴─┐                  │  »
«     qc_1 -> 3 ──■──┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──»
«               ┌─┴─┐└───┘└──────────┘└───┘     └───┘                     »
«     qc_3 -> 4 ┤ X ├─────────────────────────────────────────────────────»
«               └───┘                                                     »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                          »
«     qc_2 -> 0 ──────────────■────────────────────────────────────────────»
«               ┌──────────┐┌─┴─┐     ┌───┐                      ┌───┐     »
«     qc_0 -> 1 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■────────────■──────┤ X ├──■──»
«               └──────────┘└───┘  │  └─┬─┘  │            │      └─┬─┘  │  »
«ancilla_0 -> 2 ───────────────────┼────┼────┼────────────┼────────┼────┼──»
«                                ┌─┴─┐  │  ┌─┴─┐        ┌─┴─┐      │  ┌─┴─┐»
«     qc_1 -> 3 ─────────────────┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├»
«                                └───┘     └───┘┌─┴─┐┌──┴───┴───┐     └───┘»
«     qc_3 -> 4 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──────────»
«                                               └───┘└──────────┘          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                               ┌───┐          »
«     qc_2 -> 0 ─────────────────────────────────────────■──────┤ X ├──■───────»
«                                                      ┌─┴─┐    └─┬─┘┌─┴─┐     »
«     qc_0 -> 1 ─────────────────────────────────■─────┤ X ├──────■──┤ X ├──■──»
«                                                │     └───┘         └───┘  │  »
«ancilla_0 -> 2 ─────────────────────────────────┼──────────────────────────┼──»
«                                    ┌───┐     ┌─┴─┐┌──────────┐          ┌─┴─┐»
«     qc_1 -> 3 ──■───────────────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├──────────┤ X ├»
«               ┌─┴─┐┌─────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘          └───┘»
«     qc_3 -> 4 ┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├────────────────────────────────»
«               └───┘└─────────┘└───┘     └───┘                                »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                    »
«     qc_2 -> 0 ────────────────────────────■────────────────────────»
«                               ┌───┐     ┌─┴─┐┌──────────┐     ┌───┐»
«     qc_0 -> 1 ─────────────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├─────┤ X ├»
«                            │  └─┬─┘  │  └───┘└──────────┘     └─┬─┘»
«ancilla_0 -> 2 ─────────────┼────┼────┼──────────────────────────┼──»
«               ┌─────────┐┌─┴─┐  │  ┌─┴─┐        ┌───┐           │  »
«     qc_1 -> 3 ┤ U1(π/8) ├┤ X ├──■──┤ X ├──■─────┤ X ├──────■────■──»
«               └─────────┘└───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐     »
«     qc_3 -> 4 ──────────────────────────┤ X ├─────■──────┤ X ├─────»
«                                         └───┘            └───┘     »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                   ┌─────────────┐                    »
«     qc_2 -> 0 ─────────────────■──┤ U3(π,π/8,π) ├────────────────────»
«                 ┌─────────┐  ┌─┴─┐└─┬──────────┬┘     ┌───┐          »
«     qc_0 -> 1 ──┤ U1(π/8) ├──┤ X ├──┤ U1(-π/8) ├───■──┤ X ├──■───────»
«                 └─────────┘  └───┘  └──────────┘   │  └─┬─┘  │       »
«ancilla_0 -> 2 ─────────────────────────────────────┼────┼────┼───────»
«               ┌─────────────┐                    ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_1 -> 3 ┤ U3(π,π/8,π) ├────────────────────┤ X ├──■──┤ X ├┤ X ├»
«               └─────────────┘                    └───┘     └───┘└─┬─┘»
«     qc_3 -> 4 ────────────────────────────────────────────────────■──»
«                                                                      »
«         qm: 4/═══════════════════════════════════════════════════════»
«                                                                      »
«                                                                            »
«     qc_2 -> 0 ─────────────────────────────────────────────────────────────»
«                               ┌───┐     ┌───────────┐                      »
«     qc_0 -> 1 ─────────────■──┤ X ├──■──┤ U2(π/8,π) ├───────────────────■──»
«                            │  └─┬─┘  │  └───────────┘                   │  »
«ancilla_0 -> 2 ─────────────┼────┼────┼──────────────────────────────────┼──»
«               ┌─────────┐┌─┴─┐  │  ┌─┴─┐    ┌───┐    ┌──────────┐┌───┐┌─┴─┐»
«     qc_1 -> 3 ┤ U2(0,π) ├┤ X ├──■──┤ X ├────┤ X ├────┤ U1(-π/8) ├┤ X ├┤ X ├»
«               ├─────────┤└───┘     └───┘    └─┬─┘    └──────────┘└─┬─┘└───┘»
«     qc_3 -> 4 ┤ U1(π/8) ├─────────────────────■────────────────────■───────»
«               └─────────┘                                                  »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                         ┌───┐┌──────────┐     ┌───┐                          »
«     qc_2 -> 0 ──────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■────────────────────■──»
«               ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐┌─────────┐┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■────■──────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├»
«               └─┬─┘  │                   └───┘     └───┘└─┬─┘└─────────┘└───┘»
«ancilla_0 -> 2 ──┼────┼────────────────────────────────────┼──────────────────»
«                 │  ┌─┴─┐        ┌───┐                     │                  »
«     qc_1 -> 3 ──■──┤ X ├──■─────┤ X ├──────■──────────────■──────────────────»
«                    └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐                               »
«     qc_3 -> 4 ──────────┤ X ├─────■──────┤ X ├───────────────────────────────»
«                         └───┘            └───┘                               »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                       ┌───┐              »
«     qc_2 -> 0 ──────────────────────────────────■─────┤ X ├──────■───────»
«               ┌──────────┐┌───┐     ┌───┐     ┌─┴─┐   └─┬─┘    ┌─┴─┐     »
«     qc_0 -> 1 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──┤ X ├─────■──────┤ X ├─────»
«               └──────────┘└─┬─┘  │  └─┬─┘  │  └───┘            └───┘     »
«ancilla_0 -> 2 ──────────────┼────┼────┼────┼─────────────────────────────»
«                             │  ┌─┴─┐  │  ┌─┴─┐                      ┌───┐»
«     qc_1 -> 3 ──────────────■──┤ X ├──■──┤ X ├──■────────────────■──┤ X ├»
«                                └───┘     └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘»
«     qc_3 -> 4 ────────────────────────────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──»
«                                               └───┘└──────────┘└───┘     »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                         »
«     qc_2 -> 0 ───────────────────────────────────────────────────────■──»
«                                                          ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ───────■────────────────────────────────■──┤ X ├──■──┤ X ├»
«                      │                                │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ───────┼────────────────────────────────┼────┼────┼───────»
«                    ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──»
«               ┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘└───┘     └───┘┌─┴─┐»
«     qc_3 -> 4 ┤ X ├──────────────────■─────────────────────────────┤ X ├»
«               └───┘                                                └───┘»
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                    »
«     qc_2 -> 0 ─────────────────────────────────────────────────────»
«               ┌─────────┐     ┌───┐┌──────────┐     ┌───┐          »
«     qc_0 -> 1 ┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────»
«               └─────────┘     └─┬─┘└──────────┘  │  └─┬─┘  │       »
«ancilla_0 -> 2 ──────────────────┼────────────────┼────┼────┼───────»
«                  ┌───┐          │              ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_1 -> 3 ───┤ X ├─────■────■──────────────┤ X ├──■──┤ X ├┤ X ├»
«                  └─┬─┘   ┌─┴─┐                 └───┘     └───┘└─┬─┘»
«     qc_3 -> 4 ─────■─────┤ X ├──────────────────────────────────■──»
«                          └───┘                                     »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                    »
«     qc_2 -> 0 ──────────────────────────────────────────────────■──»
«                                    ┌─────────┐      ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ──────────────────■──┤ U2(0,π) ├───■──┤ X ├──■──┤ X ├»
«                                 │  └─────────┘   │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──────────────────┼────────────────┼────┼────┼───────»
«                 ┌─────────┐   ┌─┴─┐┌──────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ──┤ U1(π/8) ├───┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──»
«               ┌─┴─────────┴──┐└───┘└──────────┘└───┘     └───┘┌─┴─┐»
«     qc_3 -> 4 ┤ U2(0,1.2127) ├────────────────────────────────┤ X ├»
«               └──────────────┘                                └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«               ┌─────────┐     ┌───┐     ┌─────────┐               »
«     qc_2 -> 0 ┤ U2(0,π) ├──■──┤ X ├──■──┤ U2(0,π) ├────────────■──»
«               ├─────────┤┌─┴─┐└─┬─┘┌─┴─┐└─────────┘┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ┤ U2(0,π) ├┤ X ├──■──┤ X ├─────■─────┤ X ├──■──┤ X ├»
«               └─────────┘└───┘     └───┘     │     └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ───────────────────────────────┼───────┼────┼───────»
«                  ┌───┐                     ┌─┴─┐     │  ┌─┴─┐     »
«     qc_1 -> 3 ───┤ X ├─────■───────────────┤ X ├─────■──┤ X ├─────»
«                  └─┬─┘   ┌─┴─┐             └───┘        └───┘     »
«     qc_3 -> 4 ─────■─────┤ X ├────────────────────────────────────»
«                          └───┘                                    »
«         qm: 4/════════════════════════════════════════════════════»
«                                                                   »
«               ┌───────────┐ ░          ┌─┐
«     qc_2 -> 0 ┤ U3(π,0,π) ├─░──────────┤M├
«               └───────────┘ ░    ┌─┐   └╥┘
«     qc_0 -> 1 ──────────────░────┤M├────╫─
«                             ░    └╥┘    ║ 
«ancilla_0 -> 2 ──────────────░─────╫─────╫─
«                             ░ ┌─┐ ║     ║ 
«     qc_1 -> 3 ──────────────░─┤M├─╫─────╫─
«                             ░ └╥┘ ║ ┌─┐ ║ 
«     qc_3 -> 4 ──────────────░──╫──╫─┤M├─╫─
«                             ░  ║  ║ └╥┘ ║ 
«         qm: 4/═════════════════╩══╩══╩══╩═
«                                0  1  2  3 
