{'0000': 278, '0001': 265, '0010': 273, '0011': 313, '0100': 367, '0101': 276, '0110': 289, '0111': 261, '1000': 687, '1001': 389, '1010': 474, '1011': 310, '1100': 1972, '1101': 670, '1110': 761, '1111': 415}
results end
252
               ┌────────────┐          ┌───┐          ┌─────────┐            »
     qc_0 -> 0 ┤ U2(π/8,2π) ├──■───────┤ X ├───────■──┤ U1(π/8) ├────────────»
               └─┬───────┬──┘┌─┴─┐     └─┬─┘     ┌─┴─┐└─────────┘            »
     qc_3 -> 1 ──┤ U1(π) ├───┤ X ├───────■───────┤ X ├─────■─────────────────»
                 └───────┘   └───┘               └───┘     │                 »
ancilla_0 -> 2 ────────────────────────────────────────────┼─────────────────»
                ┌─────────┐  ┌───┐┌─────────────┐        ┌─┴─┐   ┌──────────┐»
     qc_1 -> 3 ─┤ U2(0,π) ├──┤ X ├┤ U3(π,π/8,π) ├────────┤ X ├───┤ U1(-π/8) ├»
                └─────────┘  └─┬─┘└┬───────────┬┘        └───┘   └──────────┘»
     qc_2 -> 4 ────────────────■───┤ U2(π/8,π) ├─────────────────────────────»
                                   └───────────┘                             »
         qm: 4/══════════════════════════════════════════════════════════════»
                                                                             »
«                                                                         »
«     qc_0 -> 0 ──────────────────────────────────────────────────────────»
«                                                                         »
«     qc_3 -> 1 ──■────────────────────────────────────■──────────────────»
«                 │                                    │                  »
«ancilla_0 -> 2 ──┼────────────────────────────────────┼──────────────────»
«               ┌─┴─┐                      ┌───┐     ┌─┴─┐┌─────────┐┌───┐»
«     qc_1 -> 3 ┤ X ├──■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├»
«               └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘»
«     qc_2 -> 4 ─────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──»
«                    └───┘└──────────┘└───┘     └───┘                     »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                     ┌───┐┌──────────┐     ┌───┐          »
«     qc_0 -> 0 ──────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────»
«                           ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐»
«     qc_3 -> 1 ────────────┤ X ├──■────■──────────────┤ X ├──■──┤ X ├┤ X ├»
«                           └─┬─┘  │                   └───┘     └───┘└─┬─┘»
«ancilla_0 -> 2 ──────────────┼────┼────────────────────────────────────┼──»
«               ┌──────────┐  │  ┌─┴─┐        ┌───┐                     │  »
«     qc_1 -> 3 ┤ U1(-π/8) ├──■──┤ X ├──■─────┤ X ├──────■──────────────■──»
«               └──────────┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐               »
«     qc_2 -> 4 ──────────────────────┤ X ├─────■──────┤ X ├───────────────»
«                                     └───┘            └───┘               »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                  ┌───┐   »
«     qc_0 -> 0 ─────────────■───────────────────────────────■─────┤ X ├───»
«               ┌─────────┐┌─┴─┐┌──────────┐     ┌───┐     ┌─┴─┐   └─┬─┘   »
«     qc_3 -> 1 ┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──┤ X ├─────■─────»
«               └─────────┘└───┘└──────────┘  │  └─┬─┘  │  └───┘           »
«ancilla_0 -> 2 ──────────────────────────────┼────┼────┼──────────────────»
«                                           ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐»
«     qc_1 -> 3 ────────────────────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├»
«                                           └───┘     └───┘└─┬─┘└─────────┘»
«     qc_2 -> 4 ─────────────────────────────────────────────■─────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                     ┌───┐                            ┌───┐»
«     qc_0 -> 0 ──■────────────■──────┤ X ├──■──────────────────────■──┤ X ├»
«               ┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐     ┌───────────┐┌─┴─┐└─┬─┘»
«     qc_3 -> 1 ┤ X ├──■─────┤ X ├──────■──┤ X ├──■──┤ U3(π,0,π) ├┤ X ├──■──»
«               └───┘  │     └───┘         └───┘  │  └───────────┘└───┘     »
«ancilla_0 -> 2 ───────┼──────────────────────────┼─────────────────────────»
«                    ┌─┴─┐┌──────────┐          ┌─┴─┐ ┌─────────┐           »
«     qc_1 -> 3 ─────┤ X ├┤ U1(-π/8) ├──────────┤ X ├─┤ U1(π/8) ├───────────»
«                    └───┘└──────────┘          └───┘ └─────────┘           »
«     qc_2 -> 4 ────────────────────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                    ┌─────────┐                       ┌───┐                  »
«     qc_0 -> 0 ──■──┤ U1(π/8) ├─────────────────■─────┤ X ├─────■────────────»
«               ┌─┴─┐└─────────┘┌─────────────┐┌─┴─┐   └─┬─┘   ┌─┴─┐          »
«     qc_3 -> 1 ┤ X ├─────■─────┤ U3(π,π/8,π) ├┤ X ├─────■─────┤ X ├──────────»
«               └───┘     │     └─────────────┘└───┘           └───┘          »
«ancilla_0 -> 2 ──────────┼───────────────────────────────────────────────────»
«                       ┌─┴─┐     ┌──────────┐ ┌───┐┌─────────┐     ┌───┐     »
«     qc_1 -> 3 ────────┤ X ├─────┤ U1(-π/8) ├─┤ X ├┤ U1(π/8) ├──■──┤ X ├──■──»
«                       └───┘     └──────────┘ └─┬─┘├─────────┤┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_2 -> 4 ─────────────────────────────────■──┤ U1(π/8) ├┤ X ├──■──┤ X ├»
«                                                   └─────────┘└───┘     └───┘»
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                                     ┌───┐┌──────────┐     ┌───┐┌─────────┐»
«     qc_0 -> 0 ──────────────────────┤ X ├┤ U1(-π/8) ├─────┤ X ├┤ U1(π/8) ├»
«               ┌───┐┌──────────┐┌───┐└─┬─┘└──────────┘┌───┐└─┬─┘└──┬───┬──┘»
«     qc_3 -> 1 ┤ X ├┤ U1(-π/8) ├┤ X ├──■───────■──────┤ X ├──■─────┤ X ├───»
«               └─┬─┘└──────────┘└─┬─┘          │      └─┬─┘        └─┬─┘   »
«ancilla_0 -> 2 ──┼────────────────┼────────────┼────────┼────────────┼─────»
«                 │                │          ┌─┴─┐      │            │     »
«     qc_1 -> 3 ──■────────────────■──────────┤ X ├──────■────────────■─────»
«                                             └───┘                         »
«     qc_2 -> 4 ────────────────────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                    ┌───┐┌──────────┐     ┌───┐                              »
«     qc_0 -> 0 ─────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■───────────────────────────»
«                    └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐                    »
«     qc_3 -> 1 ──■────■──────────────┤ X ├──■──┤ X ├┤ X ├─────────────────■──»
«                 │                   └───┘     └───┘└─┬─┘                 │  »
«ancilla_0 -> 2 ──┼────────────────────────────────────┼───────────────────┼──»
«               ┌─┴─┐                                  │       ┌───┐     ┌─┴─┐»
«     qc_1 -> 3 ┤ X ├──────────────────────────────────■────■──┤ X ├──■──┤ X ├»
«               └───┘                                     ┌─┴─┐└─┬─┘┌─┴─┐└───┘»
«     qc_2 -> 4 ──────────────────────────────────────────┤ X ├──■──┤ X ├─────»
«                                                         └───┘     └───┘     »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                           ┌───┐                                         »
«     qc_0 -> 0 ─────■──────┤ X ├──■───────────────────────────────────■──»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐                     ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ───┤ X ├──────■──┤ X ├──■───────────────■──┤ X ├──■──┤ X ├»
«                  └───┘         └───┘  │               │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ────────────────────────┼───────────────┼────┼────┼───────»
«               ┌──────────┐          ┌─┴─┐┌─────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├─────»
«               └──────────┘          └───┘└─────────┘└───┘     └───┘     »
«     qc_2 -> 4 ──────────────────────────────────────────────────────────»
«                                                                         »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                  ┌───┐             »
«     qc_0 -> 0 ─────────────────────────────■─────┤ X ├─────■───────»
«               ┌──────────┐     ┌───┐     ┌─┴─┐   └─┬─┘   ┌─┴─┐     »
«     qc_3 -> 1 ┤ U1(-π/8) ├──■──┤ X ├──■──┤ X ├─────■─────┤ X ├──■──»
«               └──────────┘  │  └─┬─┘  │  └───┘           └───┘  │  »
«ancilla_0 -> 2 ──────────────┼────┼────┼─────────────────────────┼──»
«                           ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐     ┌─┴─┐»
«     qc_1 -> 3 ────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├─────┤ X ├»
«                           └───┘     └───┘└─┬─┘└─────────┘     └───┘»
«     qc_2 -> 4 ─────────────────────────────■───────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                               ┌─────────────┐     »
«     qc_0 -> 0 ─────────────────────────────■──┤ U3(π,π/8,π) ├─────»
«                                ┌───┐     ┌─┴─┐└─┬─────────┬─┘┌───┐»
«     qc_3 -> 1 ──────────────■──┤ X ├──■──┤ X ├──┤ U1(π/8) ├──┤ X ├»
«                             │  └─┬─┘  │  └───┘  └─────────┘  └─┬─┘»
«ancilla_0 -> 2 ──────────────┼────┼────┼────────────────────────┼──»
«               ┌──────────┐┌─┴─┐  │  ┌─┴─┐                      │  »
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────────■──»
«               └──────────┘└───┘     └───┘                         »
«     qc_2 -> 4 ────────────────────────────────────────────────────»
«                                                                   »
«         qm: 4/════════════════════════════════════════════════════»
«                                                                   »
«                                                                              »
«     qc_0 -> 0 ───────────────────────────────────────────────────────────────»
«                ┌──────────┐                    ┌───┐                         »
«     qc_3 -> 1 ─┤ U1(-π/8) ├────────────────────┤ X ├──────────────────────■──»
«                └──────────┘                    └─┬─┘                      │  »
«ancilla_0 -> 2 ───────────────────────────────────┼────────────────────────┼──»
«               ┌───────────┐     ┌───┐            │       ┌─────────────┐┌─┴─┐»
«     qc_1 -> 3 ┤ U3(π,0,π) ├──■──┤ X ├──■─────────■───────┤ U3(π,π/8,π) ├┤ X ├»
«               └───────────┘┌─┴─┐└─┬─┘┌─┴─┐┌─────────────┐└─────────────┘└───┘»
«     qc_2 -> 4 ─────────────┤ X ├──■──┤ X ├┤ U3(π,π/8,π) ├────────────────────»
«                            └───┘     └───┘└─────────────┘                    »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                            ┌───┐   ┌──────────┐┌───┐     ┌───┐          »
«     qc_0 -> 0 ─────────────┤ X ├───┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────»
«               ┌───┐        └─┬─┘   └──────────┘└─┬─┘┌─┴─┐└─┬─┘┌─┴─┐     »
«     qc_3 -> 1 ┤ X ├──■───────■───────────────────■──┤ X ├──■──┤ X ├──■──»
«               └─┬─┘  │                              └───┘     └───┘  │  »
«ancilla_0 -> 2 ──┼────┼───────────────────────────────────────────────┼──»
«                 │  ┌─┴─┐┌─────────┐            ┌───┐               ┌─┴─┐»
«     qc_1 -> 3 ──■──┤ X ├┤ U1(π/8) ├─────■──────┤ X ├──■────────────┤ X ├»
«                    └───┘└─────────┘   ┌─┴─┐    └─┬─┘┌─┴─┐          └───┘»
«     qc_2 -> 4 ────────────────────────┤ X ├──────■──┤ X ├───────────────»
«                                       └───┘         └───┘               »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                           ┌───┐                                         »
«     qc_0 -> 0 ─────■──────┤ X ├──■───────────────────────────────────■──»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐                     ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ───┤ X ├──────■──┤ X ├──■───────────────■──┤ X ├──■──┤ X ├»
«                  └───┘         └───┘  │               │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ────────────────────────┼───────────────┼────┼────┼───────»
«               ┌──────────┐          ┌─┴─┐┌─────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├─────»
«               └──────────┘          └───┘└─────────┘└───┘     └───┘     »
«     qc_2 -> 4 ──────────────────────────────────────────────────────────»
«                                                                         »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                ┌───┐     »
«     qc_0 -> 0 ──────────────────────────────────────────■──────┤ X ├──■──»
«               ┌──────────┐┌───┐                       ┌─┴─┐    └─┬─┘┌─┴─┐»
«     qc_3 -> 1 ┤ U1(-π/8) ├┤ X ├─────────────────■─────┤ X ├──────■──┤ X ├»
«               └──────────┘└─┬─┘                 │     └───┘         └───┘»
«ancilla_0 -> 2 ──────────────┼───────────────────┼────────────────────────»
«                             │       ┌───┐     ┌─┴─┐┌──────────┐          »
«     qc_1 -> 3 ──────────────■────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├──────────»
«                                ┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘          »
«     qc_2 -> 4 ─────────────────┤ X ├──■──┤ X ├───────────────────────────»
«                                └───┘     └───┘                           »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                               ┌───┐                                      »
«     qc_0 -> 0 ──────────■─────┤ X ├──■───────────────────────────────────»
«                       ┌─┴─┐   └─┬─┘┌─┴─┐                                 »
«     qc_3 -> 1 ──■─────┤ X ├─────■──┤ X ├──■──────────────────────────────»
«                 │     └───┘        └───┘  │                              »
«ancilla_0 -> 2 ──┼─────────────────────────┼──────────────────────────────»
«               ┌─┴─┐┌─────────┐          ┌─┴─┐┌──────────┐┌───┐┌─────────┐»
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├──────────┤ X ├┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├»
«               └───┘└─────────┘          └───┘└──────────┘└─┬─┘└─────────┘»
«     qc_2 -> 4 ─────────────────────────────────────────────■─────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                ┌───┐                            ┌───┐     »
«     qc_0 -> 0 ──────────■──────┤ X ├──■──────────────────────■──┤ X ├──■──»
«                       ┌─┴─┐    └─┬─┘┌─┴─┐     ┌───────────┐┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_3 -> 1 ──■─────┤ X ├──────■──┤ X ├──■──┤ U3(π,0,π) ├┤ X ├──■──┤ X ├»
«                 │     └───┘         └───┘  │  └───────────┘└───┘     └───┘»
«ancilla_0 -> 2 ──┼──────────────────────────┼──────────────────────────────»
«               ┌─┴─┐┌──────────┐          ┌─┴─┐ ┌─────────┐                »
«     qc_1 -> 3 ┤ X ├┤ U1(-π/8) ├──────────┤ X ├─┤ U1(π/8) ├────────────────»
«               └───┘└──────────┘          └───┘ └─────────┘                »
«     qc_2 -> 4 ────────────────────────────────────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«               ┌─────────┐                       ┌───┐                  »
«     qc_0 -> 0 ┤ U1(π/8) ├─────────────────■─────┤ X ├─────■────────────»
«               └─────────┘┌─────────────┐┌─┴─┐   └─┬─┘   ┌─┴─┐          »
«     qc_3 -> 1 ─────■─────┤ U3(π,π/8,π) ├┤ X ├─────■─────┤ X ├──────────»
«                    │     └─────────────┘└───┘           └───┘          »
«ancilla_0 -> 2 ─────┼───────────────────────────────────────────────────»
«                  ┌─┴─┐     ┌──────────┐ ┌───┐┌─────────┐     ┌───┐     »
«     qc_1 -> 3 ───┤ X ├─────┤ U1(-π/8) ├─┤ X ├┤ U2(0,π) ├──■──┤ X ├──■──»
«                  └───┘     └──────────┘ └─┬─┘├─────────┤┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_2 -> 4 ────────────────────────────■──┤ U1(π/8) ├┤ X ├──■──┤ X ├»
«                                              └─────────┘└───┘     └───┘»
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«                                             ┌───┐┌──────────┐     ┌───┐»
«     qc_0 -> 0 ──────────────────────────────┤ X ├┤ U1(-π/8) ├─────┤ X ├»
«                   ┌───┐    ┌──────────┐┌───┐└─┬─┘└──────────┘┌───┐└─┬─┘»
«     qc_3 -> 1 ────┤ X ├────┤ U1(-π/8) ├┤ X ├──■───────■──────┤ X ├──■──»
«                   └─┬─┘    └──────────┘└─┬─┘          │      └─┬─┘     »
«ancilla_0 -> 2 ──────┼────────────────────┼────────────┼────────┼───────»
«                     │                    │          ┌─┴─┐      │       »
«     qc_1 -> 3 ──────■────────────────────■──────────┤ X ├──────■───────»
«               ┌───────────┐                         └───┘              »
«     qc_2 -> 4 ┤ U2(π/8,π) ├────────────────────────────────────────────»
«               └───────────┘                                            »
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«               ┌─────────┐     ┌───┐┌──────────┐     ┌───┐                    »
«     qc_0 -> 0 ┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■─────────────────»
«               └──┬───┬──┘     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐     ┌───┐»
«     qc_3 -> 1 ───┤ X ├─────■────■──────────────┤ X ├──■──┤ X ├┤ X ├──■──┤ X ├»
«                  └─┬─┘     │                   └───┘     └───┘└─┬─┘  │  └─┬─┘»
«ancilla_0 -> 2 ─────┼───────┼────────────────────────────────────┼────┼────┼──»
«                    │     ┌─┴─┐                                  │  ┌─┴─┐  │  »
«     qc_1 -> 3 ─────■─────┤ X ├──────────────────────────────────■──┤ X ├──■──»
«                          └───┘                                     └───┘     »
«     qc_2 -> 4 ───────────────────────────────────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                            ┌───┐                                   ┌───┐»
«     qc_0 -> 0 ───────■─────┤ X ├──────■──────────────────────■─────┤ X ├»
«                    ┌─┴─┐   └─┬─┘    ┌─┴─┐                  ┌─┴─┐   └─┬─┘»
«     qc_3 -> 1 ──■──┤ X ├─────■──────┤ X ├────────────■─────┤ X ├─────■──»
«                 │  └───┘            └───┘            │     └───┘        »
«ancilla_0 -> 2 ──┼────────────────────────────────────┼──────────────────»
«               ┌─┴─┐                      ┌───┐     ┌─┴─┐┌─────────┐┌───┐»
«     qc_1 -> 3 ┤ X ├──■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├»
«               └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘»
«     qc_2 -> 4 ─────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──»
«                    └───┘└──────────┘└───┘     └───┘                     »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                           »
«     qc_0 -> 0 ─────■──────────────────────────────────────────────────────»
«                  ┌─┴─┐                                          ┌───┐     »
«     qc_3 -> 1 ───┤ X ├──────■────────────────────────────────■──┤ X ├──■──»
«                  └───┘      │                                │  └─┬─┘  │  »
«ancilla_0 -> 2 ──────────────┼────────────────────────────────┼────┼────┼──»
«               ┌──────────┐┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  ┌─┴─┐»
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├»
«               └──────────┘└───┘└─────────┘└─┬─┘└──────────┘└───┘     └───┘»
«     qc_2 -> 4 ──────────────────────────────■─────────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                    ┌─────────┐                                     »
«     qc_0 -> 0 ──■──┤ U2(0,π) ├─────────────────────────────────────»
«               ┌─┴─┐├─────────┤     ┌───┐                           »
«     qc_3 -> 1 ┤ X ├┤ U1(π/8) ├──■──┤ X ├──■─────────────────────■──»
«               └───┘└─────────┘  │  └─┬─┘  │                     │  »
«ancilla_0 -> 2 ──────────────────┼────┼────┼─────────────────────┼──»
«                               ┌─┴─┐  │  ┌─┴─┐┌───┐┌──────────┐┌─┴─┐»
«     qc_1 -> 3 ────────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(-π/8) ├┤ X ├»
«                               └───┘     └───┘└─┬─┘├──────────┤└───┘»
«     qc_2 -> 4 ─────────────────────────────────■──┤ U2(0,2π) ├─────»
«                                                   └──────────┘     »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                   ░    ┌─┐      
«     qc_0 -> 0 ────────────────────░────┤M├──────
«                   ┌─────────┐     ░ ┌─┐└╥┘      
«     qc_3 -> 1 ────┤ U2(0,π) ├─────░─┤M├─╫───────
«                   └─────────┘     ░ └╥┘ ║       
«ancilla_0 -> 2 ────────────────────░──╫──╫───────
«               ┌─────────────────┐ ░  ║  ║    ┌─┐
«     qc_1 -> 3 ┤ U3(-π,π/2,3π/2) ├─░──╫──╫────┤M├
«               └─────────────────┘ ░  ║  ║ ┌─┐└╥┘
«     qc_2 -> 4 ────────────────────░──╫──╫─┤M├─╫─
«                                   ░  ║  ║ └╥┘ ║ 
«         qm: 4/═══════════════════════╩══╩══╩══╩═
«                                      0  1  2  3 
