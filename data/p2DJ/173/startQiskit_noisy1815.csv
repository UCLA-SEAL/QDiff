{'0000': 1049, '0001': 392, '0010': 1074, '0011': 384, '0100': 520, '0101': 332, '0110': 537, '0111': 297, '1000': 323, '1001': 440, '1010': 357, '1011': 399, '1100': 330, '1101': 629, '1110': 292, '1111': 645}
results end
257
               ┌──────────────────────┐                                     »
     qc_3 -> 0 ┤ U3(1.3415,5π/8,3π/2) ├─────────────────────────────────────»
               └────┬────────────┬────┘                                     »
     qc_0 -> 1 ─────┤ U2(π/8,2π) ├──────────────────────■────────────────■──»
                    └────────────┘                      │                │  »
ancilla_0 -> 2 ─────────────────────────────────────────┼────────────────┼──»
                    ┌───────────┐           ┌───┐     ┌─┴─┐┌──────────┐┌─┴─┐»
     qc_2 -> 3 ─────┤ U2(π/8,π) ├────────■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├┤ X ├»
                   ┌┴───────────┴┐     ┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘└───┘»
     qc_1 -> 4 ────┤ U3(π,π/8,π) ├─────┤ X ├──■──┤ X ├──────────────────────»
                   └─────────────┘     └───┘     └───┘                      »
         qm: 4/═════════════════════════════════════════════════════════════»
                                                                            »
«                                                                              »
«     qc_3 -> 0 ───────────────────────────────────────────────────────────────»
«                                ┌───┐                                         »
«     qc_0 -> 1 ──────────■──────┤ X ├──■───────────────────────────────────■──»
«                         │      └─┬─┘  │                                   │  »
«ancilla_0 -> 2 ──────────┼────────┼────┼───────────────────────────────────┼──»
«                       ┌─┴─┐      │  ┌─┴─┐                     ┌───┐     ┌─┴─┐»
«     qc_2 -> 3 ──■─────┤ X ├──────■──┤ X ├──■───────────────■──┤ X ├──■──┤ X ├»
«               ┌─┴─┐┌──┴───┴───┐     └───┘┌─┴─┐┌─────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘»
«     qc_1 -> 4 ┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├─────»
«               └───┘└──────────┘          └───┘└─────────┘└───┘     └───┘     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                               ┌───┐┌──────────┐     ┌───┐»
«     qc_3 -> 0 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├»
«                                     ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ───────────────────■──┤ X ├──■────■──────────────┤ X ├──■──»
«                                  │  └─┬─┘  │                   └───┘     »
«ancilla_0 -> 2 ───────────────────┼────┼────┼─────────────────────────────»
«               ┌──────────┐┌───┐┌─┴─┐  │  ┌─┴─┐                           »
«     qc_2 -> 3 ┤ U1(-π/8) ├┤ X ├┤ X ├──■──┤ X ├───────────────────────────»
«               └──────────┘└─┬─┘└───┘     └───┘                           »
«     qc_1 -> 4 ──────────────■────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                         »
«     qc_3 -> 0 ──■────────────────────■───────────────────────────────■──»
«               ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐     ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──┤ X ├»
«               └───┘└─┬─┘└─────────┘└───┘└──────────┘  │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ───────┼────────────────────────────────┼────┼────┼───────»
«                      │                              ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_2 -> 3 ───────■──────────────────────────────┤ X ├──■──┤ X ├┤ X ├»
«                                                     └───┘     └───┘└─┬─┘»
«     qc_1 -> 4 ───────────────────────────────────────────────────────■──»
«                                                                         »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                  ┌───┐                         ┌───┐                       »
«     qc_3 -> 0 ───┤ X ├─────■────────────■──────┤ X ├──■────────────────────»
«                  └─┬─┘   ┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐     ┌───────────┐»
«     qc_0 -> 1 ─────■─────┤ X ├──■─────┤ X ├──────■──┤ X ├──■──┤ U3(π,0,π) ├»
«                          └───┘  │     └───┘         └───┘  │  └───────────┘»
«ancilla_0 -> 2 ──────────────────┼──────────────────────────┼───────────────»
«               ┌─────────┐     ┌─┴─┐┌──────────┐          ┌─┴─┐ ┌─────────┐ »
«     qc_2 -> 3 ┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──────────┤ X ├─┤ U1(π/8) ├─»
«               └─────────┘     └───┘└──────────┘          └───┘ └─────────┘ »
«     qc_1 -> 4 ─────────────────────────────────────────────────────────────»
«                                                                            »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                    ┌───┐     ┌─────────┐                       ┌───┐        »
«     qc_3 -> 0 ──■──┤ X ├──■──┤ U1(π/8) ├─────────────────■─────┤ X ├─────■──»
«               ┌─┴─┐└─┬─┘┌─┴─┐└─────────┘┌─────────────┐┌─┴─┐   └─┬─┘   ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■──┤ X ├─────■─────┤ U3(π,π/8,π) ├┤ X ├─────■─────┤ X ├»
«               └───┘     └───┘     │     └─────────────┘└───┘           └───┘»
«ancilla_0 -> 2 ────────────────────┼─────────────────────────────────────────»
«                                 ┌─┴─┐     ┌──────────┐ ┌───┐┌─────────┐     »
«     qc_2 -> 3 ──────────────────┤ X ├─────┤ U1(-π/8) ├─┤ X ├┤ U1(π/8) ├──■──»
«                                 └───┘     └──────────┘ └─┬─┘├─────────┤┌─┴─┐»
«     qc_1 -> 4 ───────────────────────────────────────────■──┤ U1(π/8) ├┤ X ├»
«                                                             └─────────┘└───┘»
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                                               ┌───┐┌──────────┐     ┌───┐»
«     qc_3 -> 0 ────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├»
«                         ┌───┐┌──────────┐┌───┐└─┬─┘└──────────┘┌─┴─┐└─┬─┘»
«     qc_0 -> 1 ──────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──────────────┤ X ├──■──»
«                         └─┬─┘└──────────┘└─┬─┘                 └───┘     »
«ancilla_0 -> 2 ────────────┼────────────────┼─────────────────────────────»
«               ┌───┐       │                │                             »
«     qc_2 -> 3 ┤ X ├──■────■────────────────■─────────────────────────────»
«               └─┬─┘┌─┴─┐                                                 »
«     qc_1 -> 4 ──■──┤ X ├─────────────────────────────────────────────────»
«                    └───┘                                                 »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                              »
«     qc_3 -> 0 ──■────────────────────■────────────────────────────────────■──»
«               ┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐     ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──┤ X ├»
«               └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘  │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ───────┼────────────────────────────────┼────┼────┼────┼───────»
«                      │                                │  ┌─┴─┐  │  ┌─┴─┐     »
«     qc_2 -> 3 ───────■────────────────────────────────■──┤ X ├──■──┤ X ├──■──»
«                                                          └───┘     └───┘┌─┴─┐»
«     qc_1 -> 4 ──────────────────────────────────────────────────────────┤ X ├»
«                                                                         └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                  ┌───┐                                                    »
«     qc_3 -> 0 ───┤ X ├──────■─────────────────────────────────────────────»
«                  └─┬─┘    ┌─┴─┐                                           »
«     qc_0 -> 1 ─────■──────┤ X ├────────────■──────────────────────────────»
«                           └───┘            │                              »
«ancilla_0 -> 2 ─────────────────────────────┼──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_2 -> 3 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«               ┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘»
«     qc_1 -> 4 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──────────────»
«               └──────────┘└───┘     └───┘                                 »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                         »
«     qc_3 -> 0 ─────────────────■────────────────────────────────────────»
«                    ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐     ┌───┐»
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├─────┤ X ├»
«                 │  └─┬─┘  │  └───┘└─────────┘└─┬─┘└──────────┘     └─┬─┘»
«ancilla_0 -> 2 ──┼────┼────┼────────────────────┼─────────────────────┼──»
«               ┌─┴─┐  │  ┌─┴─┐        ┌───┐     │     ┌───┐           │  »
«     qc_2 -> 3 ┤ X ├──■──┤ X ├──■─────┤ X ├─────■─────┤ X ├──────■────■──»
«               └───┘     └───┘┌─┴─┐   └─┬─┘           └─┬─┘    ┌─┴─┐     »
«     qc_1 -> 4 ───────────────┤ X ├─────■───────────────■──────┤ X ├─────»
«                              └───┘                            └───┘     »
«         qm: 4/══════════════════════════════════════════════════════════»
«                                                                         »
«                                                                            »
«     qc_3 -> 0 ─────────────────────────────────────────────────────────────»
«                ┌─────────┐      ┌───┐     ┌─────────┐                 ┌───┐»
«     qc_0 -> 1 ─┤ U1(π/8) ├───■──┤ X ├──■──┤ U1(π/8) ├──────────────■──┤ X ├»
«                └─────────┘   │  └─┬─┘  │  └─────────┘              │  └─┬─┘»
«ancilla_0 -> 2 ───────────────┼────┼────┼───────────────────────────┼────┼──»
«               ┌───────────┐┌─┴─┐  │  ┌─┴─┐   ┌───┐   ┌──────────┐┌─┴─┐  │  »
«     qc_2 -> 3 ┤ U3(π,0,π) ├┤ X ├──■──┤ X ├───┤ X ├───┤ U1(-π/8) ├┤ X ├──■──»
«               └───────────┘└───┘     └───┘   └─┬─┘   ├─────────┬┘└───┘     »
«     qc_1 -> 4 ─────────────────────────────────■─────┤ U1(π/8) ├───────────»
«                                                      └─────────┘           »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                         ┌─────────────┐                                      »
«     qc_3 -> 0 ───────■──┤ U3(π,π/8,π) ├───────────────■───────────────────■──»
«                    ┌─┴─┐└─────────────┘┌───┐        ┌─┴─┐   ┌──────────┐┌─┴─┐»
«     qc_0 -> 1 ──■──┤ X ├───────■───────┤ X ├──■─────┤ X ├───┤ U1(-π/8) ├┤ X ├»
«                 │  └───┘       │       └─┬─┘  │     └───┘   └──────────┘└───┘»
«ancilla_0 -> 2 ──┼──────────────┼─────────┼────┼──────────────────────────────»
«               ┌─┴─┐          ┌─┴─┐       │  ┌─┴─┐┌─────────┐                 »
«     qc_2 -> 3 ┤ X ├──────────┤ X ├───────■──┤ X ├┤ U1(π/8) ├─────────────────»
«               └───┘          └───┘          └───┘└─────────┘                 »
«     qc_1 -> 4 ───────────────────────────────────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                      ┌───┐                                   »
«     qc_3 -> 0 ─────────────────■─────┤ X ├──────■────────────────────────────»
«                    ┌───┐     ┌─┴─┐   └─┬─┘    ┌─┴─┐                          »
«     qc_0 -> 1 ──■──┤ X ├──■──┤ X ├─────■──────┤ X ├────────────■─────────────»
«                 │  └─┬─┘  │  └───┘            └───┘            │             »
«ancilla_0 -> 2 ──┼────┼────┼────────────────────────────────────┼─────────────»
«               ┌─┴─┐  │  ┌─┴─┐                      ┌───┐     ┌─┴─┐┌─────────┐»
«     qc_2 -> 3 ┤ X ├──■──┤ X ├──■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├»
«               └───┘     └───┘┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘»
«     qc_1 -> 4 ───────────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├────────────────»
«                              └───┘└──────────┘└───┘     └───┘                »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                          ┌───┐┌──────────┐     ┌───┐     »
«     qc_3 -> 0 ───────────────────────────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──»
«                                ┌───┐     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_0 -> 1 ─────────────────┤ X ├──■────■──────────────┤ X ├──■──┤ X ├»
«                                └─┬─┘  │                   └───┘     └───┘»
«ancilla_0 -> 2 ───────────────────┼────┼──────────────────────────────────»
«               ┌───┐┌──────────┐  │  ┌─┴─┐        ┌───┐                   »
«     qc_2 -> 3 ┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■─────┤ X ├──────■────────────»
«               └─┬─┘└──────────┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐          »
«     qc_1 -> 4 ──■────────────────────────┤ X ├─────■──────┤ X ├──────────»
«                                          └───┘            └───┘          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                    »
«     qc_3 -> 0 ──────────────────■───────────────────────────────■──»
«               ┌───┐┌─────────┐┌─┴─┐┌──────────┐     ┌───┐     ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■──┤ X ├»
«               └─┬─┘└─────────┘└───┘└──────────┘  │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──┼────────────────────────────────┼────┼────┼───────»
«                 │                              ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_2 -> 3 ──■──────────────────────────────┤ X ├──■──┤ X ├┤ X ├»
«                                                └───┘     └───┘└─┬─┘»
«     qc_1 -> 4 ──────────────────────────────────────────────────■──»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                  ┌───┐                         ┌───┐                       »
«     qc_3 -> 0 ───┤ X ├─────■────────────■──────┤ X ├──■────────────────────»
«                  └─┬─┘   ┌─┴─┐        ┌─┴─┐    └─┬─┘┌─┴─┐     ┌───────────┐»
«     qc_0 -> 1 ─────■─────┤ X ├──■─────┤ X ├──────■──┤ X ├──■──┤ U3(π,0,π) ├»
«                          └───┘  │     └───┘         └───┘  │  └───────────┘»
«ancilla_0 -> 2 ──────────────────┼──────────────────────────┼───────────────»
«               ┌─────────┐     ┌─┴─┐┌──────────┐          ┌─┴─┐ ┌─────────┐ »
«     qc_2 -> 3 ┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──────────┤ X ├─┤ U1(π/8) ├─»
«               └─────────┘     └───┘└──────────┘          └───┘ └─────────┘ »
«     qc_1 -> 4 ─────────────────────────────────────────────────────────────»
«                                                                            »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                    ┌───┐     ┌─────────┐                       ┌───┐        »
«     qc_3 -> 0 ──■──┤ X ├──■──┤ U1(π/8) ├─────────────────■─────┤ X ├─────■──»
«               ┌─┴─┐└─┬─┘┌─┴─┐└─────────┘┌─────────────┐┌─┴─┐   └─┬─┘   ┌─┴─┐»
«     qc_0 -> 1 ┤ X ├──■──┤ X ├─────■─────┤ U3(π,π/8,π) ├┤ X ├─────■─────┤ X ├»
«               └───┘     └───┘     │     └─────────────┘└───┘           └───┘»
«ancilla_0 -> 2 ────────────────────┼─────────────────────────────────────────»
«                                 ┌─┴─┐     ┌──────────┐ ┌───┐┌─────────┐     »
«     qc_2 -> 3 ──────────────────┤ X ├─────┤ U1(-π/8) ├─┤ X ├┤ U2(0,π) ├──■──»
«                                 └───┘     └──────────┘ └─┬─┘├─────────┤┌─┴─┐»
«     qc_1 -> 4 ───────────────────────────────────────────■──┤ U1(π/8) ├┤ X ├»
«                                                             └─────────┘└───┘»
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                                                       ┌───┐┌──────────┐     »
«     qc_3 -> 0 ────────────────────────────────────────┤ X ├┤ U1(-π/8) ├─────»
«                             ┌───┐    ┌──────────┐┌───┐└─┬─┘└──────────┘┌───┐»
«     qc_0 -> 1 ──────────────┤ X ├────┤ U1(-π/8) ├┤ X ├──■───────■──────┤ X ├»
«                             └─┬─┘    └──────────┘└─┬─┘          │      └─┬─┘»
«ancilla_0 -> 2 ────────────────┼────────────────────┼────────────┼────────┼──»
«               ┌───┐           │                    │          ┌─┴─┐      │  »
«     qc_2 -> 3 ┤ X ├──■────────■────────────────────■──────────┤ X ├──────■──»
«               └─┬─┘┌─┴─┐┌───────────┐                         └───┘         »
«     qc_1 -> 4 ──■──┤ X ├┤ U2(π/8,π) ├───────────────────────────────────────»
«                    └───┘└───────────┘                                       »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«               ┌───┐┌─────────┐     ┌───┐┌──────────┐     ┌───┐               »
«     qc_3 -> 0 ┤ X ├┤ U1(π/8) ├─────┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■────────────»
«               └─┬─┘└──┬───┬──┘     └─┬─┘└──────────┘┌─┴─┐└─┬─┘┌─┴─┐┌───┐     »
«     qc_0 -> 1 ──■─────┤ X ├─────■────■──────────────┤ X ├──■──┤ X ├┤ X ├─────»
«                       └─┬─┘     │                   └───┘     └───┘└─┬─┘     »
«ancilla_0 -> 2 ──────────┼───────┼────────────────────────────────────┼───────»
«                         │     ┌─┴─┐                                  │       »
«     qc_2 -> 3 ──────────■─────┤ X ├──────────────────────────────────■────■──»
«                               └───┘                                     ┌─┴─┐»
«     qc_1 -> 4 ──────────────────────────────────────────────────────────┤ X ├»
«                                                                         └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                          ┌───┐                               »
«     qc_3 -> 0 ────────────────────■──────┤ X ├──■────────────────────────────»
«                                 ┌─┴─┐    └─┬─┘┌─┴─┐                     ┌───┐»
«     qc_0 -> 1 ────────────■─────┤ X ├──────■──┤ X ├──■───────────────■──┤ X ├»
«                           │     └───┘         └───┘  │               │  └─┬─┘»
«ancilla_0 -> 2 ────────────┼──────────────────────────┼───────────────┼────┼──»
«               ┌───┐     ┌─┴─┐┌──────────┐          ┌─┴─┐┌─────────┐┌─┴─┐  │  »
«     qc_2 -> 3 ┤ X ├──■──┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├┤ X ├──■──»
«               └─┬─┘┌─┴─┐└───┘└──────────┘          └───┘└─────────┘└───┘     »
«     qc_1 -> 4 ──■──┤ X ├─────────────────────────────────────────────────────»
«                    └───┘                                                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                              »
«     qc_3 -> 0 ───────■───────────────────────────────────────────────────────»
«                    ┌─┴─┐┌──────────┐     ┌───┐                          ┌───┐»
«     qc_0 -> 1 ──■──┤ X ├┤ U1(-π/8) ├──■──┤ X ├──■────────────────────■──┤ X ├»
«                 │  └───┘└──────────┘  │  └─┬─┘  │                    │  └─┬─┘»
«ancilla_0 -> 2 ──┼─────────────────────┼────┼────┼────────────────────┼────┼──»
«               ┌─┴─┐                 ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐  │  »
«     qc_2 -> 3 ┤ X ├─────────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├──■──»
«               └───┘                 └───┘     └───┘└─┬─┘└─────────┘└───┘     »
«     qc_1 -> 4 ───────────────────────────────────────■───────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                            ┌─────────┐      »
«     qc_3 -> 0 ───────■──────────────────────────────────■──┤ U2(0,π) ├──────»
«                    ┌─┴─┐┌──────────┐┌───┐ ┌─────────┐ ┌─┴─┐├─────────┴┐     »
«     qc_0 -> 1 ──■──┤ X ├┤ U1(-π/8) ├┤ X ├─┤ U1(π/8) ├─┤ X ├┤ U1(-π/8) ├──■──»
«                 │  └───┘└──────────┘└─┬─┘ └─────────┘ └───┘└──────────┘  │  »
«ancilla_0 -> 2 ──┼─────────────────────┼──────────────────────────────────┼──»
«               ┌─┴─┐                   │  ┌───────────┐                 ┌─┴─┐»
«     qc_2 -> 3 ┤ X ├───────────────────■──┤ U2(-π,2π) ├─────────────────┤ X ├»
«               └───┘                      └───────────┘                 └───┘»
«     qc_1 -> 4 ──────────────────────────────────────────────────────────────»
«                                                                             »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«                                 ┌───┐        ┌───┐                 ░    ┌─┐»
«     qc_3 -> 0 ────────────■─────┤ X ├─────■──┤ X ├─────────────────░────┤M├»
«               ┌───┐     ┌─┴─┐   └─┬─┘   ┌─┴─┐└─┬─┘                 ░    └╥┘»
«     qc_0 -> 1 ┤ X ├──■──┤ X ├─────■─────┤ X ├──■───────────────────░─────╫─»
«               └─┬─┘  │  └───┘           └───┘                      ░     ║ »
«ancilla_0 -> 2 ──┼────┼─────────────────────────────────────────────░─────╫─»
«                 │  ┌─┴─┐┌───┐┌─────────┐     ┌───┐                 ░ ┌─┐ ║ »
«     qc_2 -> 3 ──■──┤ X ├┤ X ├┤ U2(0,π) ├──■──┤ X ├──■──────────────░─┤M├─╫─»
«                    └───┘└─┬─┘├─────────┤┌─┴─┐└─┬─┘┌─┴─┐┌─────────┐ ░ └╥┘ ║ »
«     qc_1 -> 4 ────────────■──┤ U2(0,π) ├┤ X ├──■──┤ X ├┤ U2(0,π) ├─░──╫──╫─»
«                              └─────────┘└───┘     └───┘└─────────┘ ░  ║  ║ »
«         qm: 4/════════════════════════════════════════════════════════╩══╩═»
«                                                                       0  1 »
«                     
«     qc_3 -> 0 ──────
«               ┌─┐   
«     qc_0 -> 1 ┤M├───
«               └╥┘   
«ancilla_0 -> 2 ─╫────
«                ║    
«     qc_2 -> 3 ─╫────
«                ║ ┌─┐
«     qc_1 -> 4 ─╫─┤M├
«                ║ └╥┘
«         qm: 4/═╩══╩═
«                2  3 
