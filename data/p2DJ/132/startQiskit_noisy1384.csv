{'0000': 390, '0001': 306, '0010': 328, '0011': 324, '0100': 317, '0101': 278, '0110': 333, '0111': 354, '1000': 428, '1001': 582, '1010': 423, '1011': 715, '1100': 427, '1101': 614, '1110': 563, '1111': 1618}
results end
254
                  ┌────────────┐                                             »
     qc_0 -> 0 ───┤ U2(π/8,2π) ├────────────────────■────────────────■───────»
               ┌──┴────────────┴──┐     ┌───┐     ┌─┴─┐┌──────────┐┌─┴─┐     »
     qc_3 -> 1 ┤ U3(-π,5π/8,3π/2) ├──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├┤ X ├──■──»
               └──────────────────┘  │  └─┬─┘  │  └───┘└──────────┘└───┘  │  »
ancilla_0 -> 2 ──────────────────────┼────┼────┼──────────────────────────┼──»
                  ┌────────────┐   ┌─┴─┐  │  ┌─┴─┐        ┌───┐         ┌─┴─┐»
     qc_1 -> 3 ───┤ U2(π/8,2π) ├───┤ X ├──■──┤ X ├──■─────┤ X ├──────■──┤ X ├»
                  ├───────────┬┘   └───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐└───┘»
     qc_2 -> 4 ───┤ U2(π/8,π) ├───────────────────┤ X ├─────■──────┤ X ├─────»
                  └───────────┘                   └───┘            └───┘     »
         qm: 4/══════════════════════════════════════════════════════════════»
                                                                             »
«                           ┌───┐                     ┌───┐          »
«     qc_0 -> 0 ─────■──────┤ X ├──■────────────■─────┤ X ├──■───────»
«                  ┌─┴─┐    └─┬─┘┌─┴─┐        ┌─┴─┐   └─┬─┘┌─┴─┐     »
«     qc_3 -> 1 ───┤ X ├──────■──┤ X ├──■─────┤ X ├─────■──┤ X ├──■──»
«                  └───┘         └───┘  │     └───┘        └───┘  │  »
«ancilla_0 -> 2 ────────────────────────┼─────────────────────────┼──»
«               ┌──────────┐          ┌─┴─┐┌─────────┐          ┌─┴─┐»
«     qc_1 -> 3 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├──────────┤ X ├»
«               └──────────┘          └───┘└─────────┘          └───┘»
«     qc_2 -> 4 ─────────────────────────────────────────────────────»
«                                                                    »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                          »
«     qc_0 -> 0 ─────────────────────────────■─────────────────────────────»
«                                ┌───┐     ┌─┴─┐                           »
«     qc_3 -> 1 ──────────────■──┤ X ├──■──┤ X ├────────────■──────────────»
«                             │  └─┬─┘  │  └───┘            │              »
«ancilla_0 -> 2 ──────────────┼────┼────┼───────────────────┼──────────────»
«               ┌──────────┐┌─┴─┐  │  ┌─┴─┐     ┌───┐     ┌─┴─┐┌──────────┐»
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├»
«               └──────────┘└───┘     └───┘┌─┴─┐└─┬─┘┌─┴─┐└───┘└──────────┘»
«     qc_2 -> 4 ───────────────────────────┤ X ├──■──┤ X ├─────────────────»
«                                          └───┘     └───┘                 »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                ┌───┐                     »
«     qc_0 -> 0 ──────────────────────────■──────┤ X ├──■──────────────────»
«                                       ┌─┴─┐    └─┬─┘┌─┴─┐                »
«     qc_3 -> 1 ──────────────────■─────┤ X ├──────■──┤ X ├──■─────────────»
«                                 │     └───┘         └───┘  │             »
«ancilla_0 -> 2 ──────────────────┼──────────────────────────┼─────────────»
«               ┌───┐┌─────────┐┌─┴─┐┌──────────┐          ┌─┴─┐┌─────────┐»
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├»
«               └─┬─┘└─────────┘└───┘└──────────┘          └───┘└─────────┘»
«     qc_2 -> 4 ──■────────────────────────────────────────────────────────»
«                                                                          »
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«                                                                             »
«     qc_0 -> 0 ─────────────────■─────────────────────────────────────────■──»
«                    ┌───┐     ┌─┴─┐┌──────────┐     ┌───┐  ┌─────────┐  ┌─┴─┐»
«     qc_3 -> 1 ──■──┤ X ├──■──┤ X ├┤ U1(-π/8) ├─────┤ X ├──┤ U1(π/8) ├──┤ X ├»
«                 │  └─┬─┘  │  └───┘└──────────┘     └─┬─┘  └─────────┘  └───┘»
«ancilla_0 -> 2 ──┼────┼────┼──────────────────────────┼──────────────────────»
«               ┌─┴─┐  │  ┌─┴─┐        ┌───┐           │  ┌─────────────┐     »
«     qc_1 -> 3 ┤ X ├──■──┤ X ├──■─────┤ X ├──────■────■──┤ U3(π,π/8,π) ├─────»
«               └───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐     └─────────────┘     »
«     qc_2 -> 4 ───────────────┤ X ├─────■──────┤ X ├─────────────────────────»
«                              └───┘            └───┘                         »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«               ┌─────────────┐                                              »
«     qc_0 -> 0 ┤ U3(π,π/8,π) ├──────────────────────────────────────────────»
«               └─┬──────────┬┘     ┌───┐                          ┌───┐     »
«     qc_3 -> 1 ──┤ U1(-π/8) ├───■──┤ X ├──■────────────────────■──┤ X ├──■──»
«                 └──────────┘   │  └─┬─┘  │                    │  └─┬─┘  │  »
«ancilla_0 -> 2 ─────────────────┼────┼────┼────────────────────┼────┼────┼──»
«                              ┌─┴─┐  │  ┌─┴─┐┌───┐┌─────────┐┌─┴─┐  │  ┌─┴─┐»
«     qc_1 -> 3 ───────────────┤ X ├──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├──■──┤ X ├»
«                              └───┘     └───┘└─┬─┘├─────────┤└───┘     └───┘»
«     qc_2 -> 4 ────────────────────────────────■──┤ U1(π/8) ├───────────────»
«                                                  └─────────┘               »
«         qm: 4/═════════════════════════════════════════════════════════════»
«                                                                            »
«                                                    ┌───┐┌──────────┐     »
«     qc_0 -> 0 ─────────────────────────────────────┤ X ├┤ U1(-π/8) ├──■──»
«                                          ┌───┐     └─┬─┘└──────────┘┌─┴─┐»
«     qc_3 -> 1 ────────────────────────■──┤ X ├──■────■──────────────┤ X ├»
«                                       │  └─┬─┘  │                   └───┘»
«ancilla_0 -> 2 ────────────────────────┼────┼────┼────────────────────────»
«               ┌───┐┌──────────┐┌───┐┌─┴─┐  │  ┌─┴─┐        ┌───┐         »
«     qc_1 -> 3 ┤ X ├┤ U1(-π/8) ├┤ X ├┤ X ├──■──┤ X ├──■─────┤ X ├──────■──»
«               └─┬─┘└──────────┘└─┬─┘└───┘     └───┘┌─┴─┐   └─┬─┘    ┌─┴─┐»
«     qc_2 -> 4 ──■────────────────■─────────────────┤ X ├─────■──────┤ X ├»
«                                                    └───┘            └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════»
«                                                                          »
«               ┌───┐                                                          »
«     qc_0 -> 0 ┤ X ├──■────────────────────■──────────────────────────────────»
«               └─┬─┘┌─┴─┐┌───┐┌─────────┐┌─┴─┐┌──────────┐┌───┐     ┌───┐     »
«     qc_3 -> 1 ──■──┤ X ├┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──»
«                    └───┘└─┬─┘└─────────┘└───┘└──────────┘└─┬─┘  │  └─┬─┘  │  »
«ancilla_0 -> 2 ────────────┼────────────────────────────────┼────┼────┼────┼──»
«                           │                                │  ┌─┴─┐  │  ┌─┴─┐»
«     qc_1 -> 3 ────────────■────────────────────────────────■──┤ X ├──■──┤ X ├»
«                                                               └───┘     └───┘»
«     qc_2 -> 4 ───────────────────────────────────────────────────────────────»
«                                                                              »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                       ┌───┐                                        »
«     qc_0 -> 0 ──■─────┤ X ├──────■─────────────────────────────────»
«               ┌─┴─┐   └─┬─┘    ┌─┴─┐                               »
«     qc_3 -> 1 ┤ X ├─────■──────┤ X ├────────────■──────────────────»
«               └───┘            └───┘            │                  »
«ancilla_0 -> 2 ──────────────────────────────────┼──────────────────»
«                                     ┌───┐     ┌─┴─┐┌─────────┐┌───┐»
«     qc_1 -> 3 ──■────────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├»
«               ┌─┴─┐┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘»
«     qc_2 -> 4 ┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──»
«               └───┘└──────────┘└───┘     └───┘                     »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                    »
«     qc_0 -> 0 ─────────────────────────────■───────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐     ┌───┐»
«     qc_3 -> 1 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├─────┤ X ├»
«                             │  └─┬─┘  │  └───┘└─────────┘     └─┬─┘»
«ancilla_0 -> 2 ──────────────┼────┼────┼─────────────────────────┼──»
«               ┌──────────┐┌─┴─┐  │  ┌─┴─┐        ┌───┐          │  »
«     qc_1 -> 3 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■─────┤ X ├─────■────■──»
«               └──────────┘└───┘     └───┘┌─┴─┐   └─┬─┘   ┌─┴─┐     »
«     qc_2 -> 4 ───────────────────────────┤ X ├─────■─────┤ X ├─────»
«                                          └───┘           └───┘     »
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                   »
«     qc_0 -> 0 ────────────────────────────────────────────────────»
«               ┌──────────┐     ┌───┐                              »
«     qc_3 -> 1 ┤ U1(-π/8) ├──■──┤ X ├──■────────────────────────■──»
«               └──────────┘  │  └─┬─┘  │                        │  »
«ancilla_0 -> 2 ──────────────┼────┼────┼────────────────────────┼──»
«                           ┌─┴─┐  │  ┌─┴─┐┌───┐  ┌─────────┐  ┌─┴─┐»
«     qc_1 -> 3 ────────────┤ X ├──■──┤ X ├┤ X ├──┤ U1(π/8) ├──┤ X ├»
«                           └───┘     └───┘└─┬─┘┌─┴─────────┴─┐└───┘»
«     qc_2 -> 4 ─────────────────────────────■──┤ U3(π,π/8,π) ├─────»
«                                               └─────────────┘     »
«         qm: 4/════════════════════════════════════════════════════»
«                                                                   »
«                                                          ┌─────────────┐     »
«     qc_0 -> 0 ───────────────────────────────────■───────┤ U3(π,π/8,π) ├──■──»
«               ┌───────────┐     ┌───┐          ┌─┴─┐     └─────────────┘┌─┴─┐»
«     qc_3 -> 1 ┤ U3(π,0,π) ├──■──┤ X ├──■───────┤ X ├────────────────────┤ X ├»
«               └───────────┘  │  └─┬─┘  │       └───┘                    └───┘»
«ancilla_0 -> 2 ───────────────┼────┼────┼─────────────────────────────────────»
«                ┌──────────┐┌─┴─┐  │  ┌─┴─┐┌─────────────┐               ┌───┐»
«     qc_1 -> 3 ─┤ U1(-π/8) ├┤ X ├──■──┤ X ├┤ U3(π,π/8,π) ├───────■───────┤ X ├»
«                └──────────┘└───┘     └───┘└─────────────┘     ┌─┴─┐     └─┬─┘»
«     qc_2 -> 4 ────────────────────────────────────────────────┤ X ├───────■──»
«                                                               └───┘          »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«               ┌───┐     ┌─────────┐                                       »
«     qc_0 -> 0 ┤ X ├──■──┤ U1(π/8) ├───────────────────────────────────────»
«               └─┬─┘┌─┴─┐└─────────┘                                       »
«     qc_3 -> 1 ──■──┤ X ├─────■───────────────────■────────────────────────»
«                    └───┘     │                   │                        »
«ancilla_0 -> 2 ───────────────┼───────────────────┼────────────────────────»
«                            ┌─┴─┐   ┌──────────┐┌─┴─┐                      »
«     qc_1 -> 3 ──■──────────┤ X ├───┤ U1(-π/8) ├┤ X ├──■────────────────■──»
«               ┌─┴─┐        └───┘   └──────────┘└───┘┌─┴─┐┌──────────┐┌─┴─┐»
«     qc_2 -> 4 ┤ X ├─────────────────────────────────┤ X ├┤ U1(-π/8) ├┤ X ├»
«               └───┘                                 └───┘└──────────┘└───┘»
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                    ┌───┐     »
«     qc_0 -> 0 ──────────────────────────────────────────────────■──┤ X ├──■──»
«                                                               ┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_3 -> 1 ────────────■────────────────────────────────■──┤ X ├──■──┤ X ├»
«                           │                                │  └───┘     └───┘»
«ancilla_0 -> 2 ────────────┼────────────────────────────────┼─────────────────»
«               ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐               »
«     qc_1 -> 3 ┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├───────────────»
«               └─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘└───┘               »
«     qc_2 -> 4 ──■──┤ X ├──────────────────■──────────────────────────────────»
«                    └───┘                                                     »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                                              »
«     qc_0 -> 0 ────────────────────────────────────────────────────────────■──»
«               ┌───┐┌──────────┐          ┌───┐┌─────────┐     ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ┤ X ├┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├──■──┤ X ├──■──┤ X ├»
«               └─┬─┘└──────────┘          └─┬─┘└─────────┘  │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──┼──────────────────────────┼───────────────┼────┼────┼───────»
«                 │              ┌───┐       │             ┌─┴─┐  │  ┌─┴─┐┌───┐»
«     qc_1 -> 3 ──■───────■──────┤ X ├──■────■─────────────┤ X ├──■──┤ X ├┤ X ├»
«                       ┌─┴─┐    └─┬─┘┌─┴─┐                └───┘     └───┘└─┬─┘»
«     qc_2 -> 4 ────────┤ X ├──────■──┤ X ├─────────────────────────────────■──»
«                       └───┘         └───┘                                    »
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                  ┌───┐                                                    »
«     qc_0 -> 0 ───┤ X ├──────■─────────────────────────────────────────────»
«                  └─┬─┘    ┌─┴─┐                                      ┌───┐»
«     qc_3 -> 1 ─────■──────┤ X ├──■────────────────────────────────■──┤ X ├»
«                           └───┘  │                                │  └─┬─┘»
«ancilla_0 -> 2 ───────────────────┼────────────────────────────────┼────┼──»
«               ┌──────────┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  »
«     qc_1 -> 3 ┤ U1(-π/8) ├─────┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──»
«               └──────────┘     └───┘└─────────┘└─┬─┘└──────────┘└───┘     »
«     qc_2 -> 4 ───────────────────────────────────■────────────────────────»
«                                                                           »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                         ┌─────────────┐                                      »
«     qc_0 -> 0 ───────■──┤ U3(π,π/8,π) ├──────────────────────────────────────»
«                    ┌─┴─┐└─┬─────────┬─┘     ┌───┐ ┌──────────┐               »
«     qc_3 -> 1 ──■──┤ X ├──┤ U1(π/8) ├───────┤ X ├─┤ U1(-π/8) ├───────────────»
«                 │  └───┘  └─────────┘       └─┬─┘ └──────────┘               »
«ancilla_0 -> 2 ──┼─────────────────────────────┼──────────────────────────────»
«               ┌─┴─┐          ┌───┐            │  ┌───────────┐     ┌───┐     »
«     qc_1 -> 3 ┤ X ├──■───────┤ X ├───────■────■──┤ U3(π,0,π) ├──■──┤ X ├──■──»
«               └───┘┌─┴─┐     └─┬─┘     ┌─┴─┐     └───────────┘┌─┴─┐└─┬─┘┌─┴─┐»
«     qc_2 -> 4 ─────┤ X ├───────■───────┤ X ├──────────────────┤ X ├──■──┤ X ├»
«                    └───┘               └───┘                  └───┘     └───┘»
«         qm: 4/═══════════════════════════════════════════════════════════════»
«                                                                              »
«                                                        ┌───┐    ┌──────────┐»
«     qc_0 -> 0 ─────────────────────────────────────────┤ X ├────┤ U1(-π/8) ├»
«                  ┌───┐   ┌─────────┐     ┌───┐         └─┬─┘    └──────────┘»
«     qc_3 -> 1 ───┤ X ├───┤ U2(0,π) ├──■──┤ X ├──■────────■──────────────────»
«                  └─┬─┘   └─────────┘  │  └─┬─┘  │                           »
«ancilla_0 -> 2 ─────┼──────────────────┼────┼────┼───────────────────────────»
«                    │     ┌─────────┐┌─┴─┐  │  ┌─┴─┐┌───────────┐            »
«     qc_1 -> 3 ─────■─────┤ U1(π/8) ├┤ X ├──■──┤ X ├┤ U2(π/8,π) ├─────■──────»
«               ┌─────────┐└─────────┘└───┘     └───┘└───────────┘   ┌─┴─┐    »
«     qc_2 -> 4 ┤ U1(π/8) ├──────────────────────────────────────────┤ X ├────»
«               └─────────┘                                          └───┘    »
«         qm: 4/══════════════════════════════════════════════════════════════»
«                                                                             »
«               ┌───┐     ┌───┐                                          »
«     qc_0 -> 0 ┤ X ├──■──┤ X ├──■────────────────────────────────────■──»
«               └─┬─┘┌─┴─┐└─┬─┘┌─┴─┐                      ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ──■──┤ X ├──■──┤ X ├──■────────────────■──┤ X ├──■──┤ X ├»
«                    └───┘     └───┘  │                │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──────────────────────┼────────────────┼────┼────┼───────»
«               ┌───┐               ┌─┴─┐┌──────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ┤ X ├──■────────────┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├─────»
«               └─┬─┘┌─┴─┐          └───┘└──────────┘└───┘     └───┘     »
«     qc_2 -> 4 ──■──┤ X ├───────────────────────────────────────────────»
«                    └───┘                                               »
«         qm: 4/═════════════════════════════════════════════════════════»
«                                                                        »
«                                                                    »
«     qc_0 -> 0 ──────────────────────────────■──────────────────────»
«               ┌─────────┐┌───┐┌──────────┐┌─┴─┐     ┌───┐          »
«     qc_3 -> 1 ┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■───────»
«               └─────────┘└─┬─┘└──────────┘└───┘  │  └─┬─┘  │       »
«ancilla_0 -> 2 ─────────────┼─────────────────────┼────┼────┼───────»
«                            │                   ┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ─────────────■───────────────────┤ X ├──■──┤ X ├──■──»
«                                                └───┘     └───┘┌─┴─┐»
«     qc_2 -> 4 ────────────────────────────────────────────────┤ X ├»
«                                                               └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                                                                    »
«     qc_0 -> 0 ──────────────────────────────────────────────────■──»
«                           ┌───┐                     ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ─────■──────┤ X ├──■────────────■─────┤ X ├──■──┤ X ├»
«                    │      └─┬─┘  │            │     └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ─────┼────────┼────┼────────────┼───────┼────┼───────»
«                  ┌─┴─┐      │  ┌─┴─┐        ┌─┴─┐     │  ┌─┴─┐     »
«     qc_1 -> 3 ───┤ X ├──────■──┤ X ├──■─────┤ X ├─────■──┤ X ├──■──»
«               ┌──┴───┴───┐     └───┘┌─┴─┐┌──┴───┴──┐     └───┘┌─┴─┐»
«     qc_2 -> 4 ┤ U1(-π/8) ├──────────┤ X ├┤ U1(π/8) ├──────────┤ X ├»
«               └──────────┘          └───┘└─────────┘          └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«                  ┌───┐                                   ┌───┐            »
«     qc_0 -> 0 ───┤ X ├──────■──────────────────────■─────┤ X ├─────■──────»
«                  └─┬─┘    ┌─┴─┐                  ┌─┴─┐   └─┬─┘   ┌─┴─┐    »
«     qc_3 -> 1 ─────■──────┤ X ├────────────■─────┤ X ├─────■─────┤ X ├────»
«                           └───┘            │     └───┘           └───┘    »
«ancilla_0 -> 2 ─────────────────────────────┼──────────────────────────────»
«                                ┌───┐     ┌─┴─┐┌─────────┐┌───┐┌──────────┐»
«     qc_1 -> 3 ──────────────■──┤ X ├──■──┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├»
«               ┌──────────┐┌─┴─┐└─┬─┘┌─┴─┐└───┘└─────────┘└─┬─┘└──────────┘»
«     qc_2 -> 4 ┤ U1(-π/8) ├┤ X ├──■──┤ X ├──────────────────■──────────────»
«               └──────────┘└───┘     └───┘                                 »
«         qm: 4/════════════════════════════════════════════════════════════»
«                                                                           »
«                                                                    »
«     qc_0 -> 0 ──────────────────────────────────────────────────■──»
«                    ┌─────────┐                      ┌───┐     ┌─┴─┐»
«     qc_3 -> 1 ──■──┤ U2(0,π) ├───────────────────■──┤ X ├──■──┤ X ├»
«                 │  └─────────┘                   │  └─┬─┘  │  └───┘»
«ancilla_0 -> 2 ──┼────────────────────────────────┼────┼────┼───────»
«               ┌─┴─┐┌─────────┐┌───┐┌──────────┐┌─┴─┐  │  ┌─┴─┐     »
«     qc_1 -> 3 ┤ X ├┤ U1(π/8) ├┤ X ├┤ U1(-π/8) ├┤ X ├──■──┤ X ├──■──»
«               └───┘└─────────┘└─┬─┘└──────────┘└───┘     └───┘┌─┴─┐»
«     qc_2 -> 4 ──────────────────■─────────────────────────────┤ X ├»
«                                                               └───┘»
«         qm: 4/═════════════════════════════════════════════════════»
«                                                                    »
«               ┌─────────┐ ░ ┌─┐         
«     qc_0 -> 0 ┤ U2(0,π) ├─░─┤M├─────────
«               └─────────┘ ░ └╥┘      ┌─┐
«     qc_3 -> 1 ────────────░──╫───────┤M├
«                           ░  ║       └╥┘
«ancilla_0 -> 2 ────────────░──╫────────╫─
«                           ░  ║ ┌─┐    ║ 
«     qc_1 -> 3 ────────────░──╫─┤M├────╫─
«               ┌─────────┐ ░  ║ └╥┘┌─┐ ║ 
«     qc_2 -> 4 ┤ U2(π,π) ├─░──╫──╫─┤M├─╫─
«               └─────────┘ ░  ║  ║ └╥┘ ║ 
«         qm: 4/═══════════════╩══╩══╩══╩═
«                              0  1  2  3 
